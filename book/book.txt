


Криптография - это наука о математических методах преобразования информации, которые могут обеспечить конфиденциальность (невозможность получить доступ к информации посторонним) и целостность (невозможность незаметного изменения информации), а также скрыть сам факт передачи информации.
Криптография сопровождала человечество на протяжении многих лет и играла важную роль как на государственном, так и на общечеловеческом уровне.
Короли и королевы, которые не хотели выдать ценные секреты вражеским государствам, полководцы, скрывающие жизненно важные сведения от противника, простые обыватели, желающие сохранить тайну переписки, - все эти люди использовали средства криптографии.

Документально зафиксированная история криптографии берёт начало в древнеегипетском городе Менат-Хуфу, где почти 4 тысячи лет назад один опытный летописец нарисовал иероглифы на могиле дворянина Хнумхотепа II, которые рассказывали историю жизни его господина.

Жители Иудейского царства (500 г. до н. э.) изобрели простейший шифр замены <b>атбаш</b>. Чтобы им воспользоваться, нужно написать алфавит два раза  —  один раз в обычном порядке, второй раз в обратном. Для того, чтобы зашифровать сообщение, буквы из него надо заменить на соответствующие им буквы из второго (инвертированного) алфавита.
<i>Узнать подробнее о шифре атбаш и зашифровать сообщение вы можете в Музее криптографии в зале «Протокриптография».</i>

По данным историков, в Древней Спарте (487 г. до н.э.) создали первое устройство для  шифрования – <b>скитала</b>. Суть его состояла в том, что на цилиндр, диаметр которого был  заранее согласован, наматывали тонкий ремень из пергамента и текст выписывался построчно вдоль его оси. Затем ремень сматывался и отправлялся получателю сообщения, который наматывал ремень на цилиндр такого же диаметра, как и у отправителя.
Шифр, который реализует скитала, можно рассматривать как шифр перестановки – тип шифра, когда блоки (буквы, цифры, биты) сообщения меняются местами друг с другом.
<i>Вы можете попробовать сами зашифровать и расшифровать сообщение с помощью скиталы в Музее криптографии на столе-практикуме в зале «Протокриптография».</i>

Древнегреческий полководец Эней «Тактик» предложил устройство, которое впоследствии назвали <b>диском Энея</b>.
Его суть была очень проста. На диске высверливались отверстия по количеству букв алфавита, а в центре помещалась катушка с ниткой. При зашифровании нитку протягивали через отверстия, соответствующие буквам шифруемого текста. Получатель вытягивал нитку из отверстий, что позволяло ему получить передаваемое сообщение, но в обратном порядке следования букв.

При перехвате диска недоброжелатель имел возможность прочитать сообщение описанным ранее способом, но Эней предусмотрел возможность легкого уничтожения сообщения при угрозе захвата диска. Для этого было достаточно выдернуть катушку с закрепленным на ней концом нити до полного выхода нити из всех отверстий диска.
<i>Зашифровать сообщение с помощью диска Энея, а также узнать о других способах сокрытия информации, описанных им, вы можете в Музее криптографии.</i>

<b>Квадрат Полибия</b>
Греческий писатель Полибий (150 г. до н.э.) использовал систему сигнализации, которая позже легла в основу многих методов шифрования. Он записывал буквы алфавита в квадратную таблицу и заменял их координатами: парами чисел (i, j), где i — номер строки, j — номер столбца.
Например, сообщение «ЗАВТРА» может быть записано так: (2, 3), (1, 1), (1, 3), (4, 2), (3, 6), (1, 1).

<i>Зашифровать сообщение с помощью квадрата Полибия, а также передать его одним из реально использовавшихся способов вы можете в Музее криптографии.</i>

<b>Шифр Цезаря</b>
Юлий Цезарь (50 г. до н.э.) использовал для тайной правительственной переписки шифр простой замены, который впоследствии назвали в его честь.
Шифр простой замены — вид шифра, в котором для каждой буквы открытого текста существует однозначная сопоставленная ей буква из шифртекста.
Суть шифра Цезаря заключается в том, что каждая буква в открытом тексте заменяется символом, находящимся на постоянном числе позиций левее или правее от него в алфавите.
Например, в шифре со сдвигом вправо на 3, А будет заменена Г, Б станет Д и так далее.

Для удобства шифр Цезаря можно представить в виде диска.
<i>Узнать подробнее о шифре Цезаря вы можете в Музее Криптографии.</i>

<b>Частотный анализ</b>
Основными характеристиками текстов, используемыми в криптографии, являются:
 1. Повторяемость букв, пар букв, троек и m-ок (m-грамм) букв;
 2. Сочетаемость букв друг с другом;
 3. Чередование гласных и согласных букв.
Что представляет из себя частотный анализ? На основе большого корпуса текстов были подсчитаны частоты встречаемости каждой буквы алфавита. Для наглядности рассмотрим русский алфавит.

Самая часто встречающаяся буква — О, вероятность, что следующая прочитанная буква будет именно буквой О, равна 9%. Следующая в порядке убывания частоты —  буква Е (Ё), и вероятность встретить ее равна 7.2%. По такому принципу ранжируются все буквы алфавита.
В зашифрованном тексте проводится такой же частотный анализ, в результате которого появляется свой список с частотами встречаемых букв алфавита.
Эти два списка частот сопоставляются между собой, и устанавливается соответствие между буквами открытого текста и шифртекста.
<i>В Музее криптографии в зале «Протокриптография» вы можете найти инсталляцию о частотном анализе и узнать о некоторых известных текстах, которые были дешифрованы с его помощью.</i>


С падением Римской империи в интеллектуальной деятельности человечества наступил упадок. Католическая церковь ввела запрет на использование любых средств сокрытия информации, так как это считалось сокрытием тайн от Господа, тайнопись стала «ересью». За использование тайнописи предусматривались жесткие меры наказания, вплоть до смертной казни.
Возрождение криптографии произошло только в VIII веке н.э. в период расцвета арабских государств. Именно арабы ввели в употребление такие слова как «цифра», «шифр» и «алгоритм».
Первое упоминание о частотном криптоанализе отмечено в IX веке в книге Аль-Кинди «Манускрипт о дешифровке криптографических сообщений».
<i>Подробнее о частотном криптоанализе — в инсталляции «Частотный анализ» в Музее криптографии. Также вы можете подробнее ознакомиться с работой Аль-Кинди в близлежащей инсталляции «Аль-Кинди» в Музее криптографии.</i>

В 1412 году вышла в свет 14-томная энциклопедия «Шауба-аль-Аша» («Светоч для незрячего в ремесле писца»). Она была написана для служащих государственной канцелярии (Дивана записей и переписки). Среди прочего, в этой книге описаны такие системы шифрования, как замены букв на другие буквы, символы, цифры и другие методы.

<b>Византийская тайнопись</b>
Информацию о византийской тайнописи мы можем восстановить только по косвенным источникам, в том числе по результатам работы русского ученого М.Н. Сперанского, который систематизировал способы византийской тайнописи на основе славянской тайнописи. Он отметил такие способы, как например:
 - Замена букв греческого алфавита буквами из других алфавитов: латинского, арабского, кириллицы, глаголицы;
 - Сокрытие информации в акростихе — особой форме стихотворных текстов, где исходный открытый текст читался по буквам, стоящим на определенных позициях (чаще всего — в начале каждой строки);

 - «Лигатурное письмо» — особые фигурные знаки, позволяющие опознать писца или адресата, как правило, ставившиеся в начале или в конце документа, прообраз современной собственноручной подписи;

 - «Цифровая тайнопись» – замена обычных букв иными на основе их численного значения.
<i>Подробнее о славянской тайнописи вы можете узнать в зале «Протокриптография» Музея криптографии.</i>

В истории Европы Средневековье длилось примерно с конца V по начало XVI веков. Данная эпоха делится на 3 больших периода:
 - Раннее Средневековье: конец V — середина XI вв.
 - Высокое или классическое Средневековье: середина XI — конец XIV вв.
 - Позднее Средневековье или раннее Новое время: XIV—XVI вв.
Рассмотрим каждый из периодов более детально с точки зрения криптографии.

Раннее Средневековье характеризовалось применением следующих шифров:
 - Античные шифры (которые рассматривались ранее)
 - Колонная перестановка
 - Обратный порядок записи
 - Редукция гласных
 - Использование иностранных или вымышленных алфавитов
Рассмотрим поподробнее некоторые из указанных шифров.

<b>Колонная перестановка</b>
Колонная перестановка является шифром перестановки. Чтобы его реализовать,необходимо записать в таблицу исходный открытый текст построчно (слева направо и сверху вниз), а затем считать буквы по колонкам (сверху вниз и слева направо), таким образом будет получен шифртекст. Расшифрование происходит аналогично, необходимо записать зашифрованное сообщение поколонно и прочитать открытый текст по горизонтали.

<b>Магические квадраты</b>
Магические квадраты размера n×n – квадратные таблицы размера n со следующими свойствами:
 - В каждой клетке одно из натуральных чисел, не больше n*n
 - По каждой строке, каждому столбцу, а также по любой из двух диагоналей размера n получаем одинаковую сумму, равную  n(n*n+1)/2
Необходимо вписать открытый текст по одной букве в каждую ячейку в соответствии с цифрой в ячейке и после заполнения таблицы надо считать буквы построчно.
<i>Подробнее о магических квадратах и акростихах можно узнать в Музее криптографии в разделе «Магия» в зале «Протокриптография».</i>

В лозунговом шифре замена букв определяется так: под алфавитом пишутся различные буквы лозунга в порядке появления, а затем буквы, не появившиеся в лозунге.

Габриэль де Лавинд по просьбе папы Климентия VII составил комбинированный алфавит замены и способ зашифрования отдельных слов. Данный шифр является наиболее ранним известным примером номенклатора.
Номенклатор – шифр, представляющий собой комбинацию шифра замены для букв открытого текста и кодовую книгу. Номенклатор обычно содержал кодовые эквиваленты букв алфавита и наиболее употребительных слогов, слов и словосочетаний, а также ряд специальных символов. Чаще всего в нем встречались специально созданные для этой цели символы, но нередко также использовалась астрологическая и оккультная символика.

Знаменитый итальянский архитектор Леон Батиста Альберти в своем труде «Трактат о шифрах» (1466 г.) впервые предложил шифр многоалфавитной замены. В этой работе был предложен шифр, основанный на использовании шифровального диска. Сам Альберти назвал его шифром, «достойным королей». Данный диск реализует 5 режимов шифрования.

<b>Режим 1</b>
Первая буква сообщения на внутреннем диске совмещается с самой собой на внешнем диске. Соответственно, зашифровывается сама в себя. После этого внутренний диск сдвигается на 1 позицию по часовой стрелке, вторая буква открытого текста отыскивается на внешнем диске, заменяется на букву с внутреннего диска, диск снова сдвигается на 1 позицию по часовой стрелке и т. д.
Например, зашифруем слово «АРИЯ». Первая буква А перейдёт в саму себя. После чего, повернём внутренний диск на 1 деление и получим новый алфавит. Вторая буква Р перейдёт в букву Ю. После чего, повернём внутренний диск на 1 деление и получим новый алфавит. Третья буква И перейдёт в букву О. После чего, повернём внутренний диск на 1 деление и получим новый алфавит. Последняя буква Я перейдёт в букву Р. Таким образом, получили шифртекст: «АЮОР».

<b>Режим 2</b>
Первая буква сообщения на внутреннем диске устанавливается напротив буквы «А» на внешнем диске, после чего её соответствие ищется на внешнем диске. Далее после каждого зашифрования 1 символа внутренний диск поворачивается на 1 символ по часовой стрелке и т. д.
Например, зашифруем слово «ХАОС». Для этого букву Х на внутреннем диске установим под буквой А на внешнем диске. Далее каждый раз будем поворачивать внутренний диск по часовой стрелке на 1 символ. Таким образом, получили шифртекст: «ТМДЫ».

<b>Режим 3</b>
Выбирается индикаторная буква, которая устанавливается напротив первой буквы алфавита. После зашифрования каждой буквы внутренний диск поворачивается на 1 символ по часовой стрелке.
Например, в качестве индикаторной буквы выберем букву Х. Установим её под первой буквой алфавита. Зашифруем слово «ВОИН». Таким образом, получили шифртекст: «ФЯБЬ».

<b>Режим 4</b>
Выбирается произвольная буква на внутреннем диске, которая устанавливается напротив буквы «А» на внешнем диске. Эта буква записывается в виде заглавной буквы. Несколько символов (например, 5) шифруются без движения внутреннего диска. Затем в шифртексте снова ставится заглавная буква напротив буквы «А», задающая новое положение диска. Шифруются следующие 5 букв и т.д.

<b>Режим 5</b>
Выбирается пароль или лозунг. Первая буква пароля совмещается с буквой «А» внешнего диска, производится шифрование первой буквы открытого текста. Затем с буквой «А» совмещается вторая буква пароля и шифруется вторая буква текста и т.д.
<i>Воспользоваться диском Альберти вы можете в Музее криптографии.</i>

В Милане в 1469 г. был предложен шифр, получивший название «миланский ключ», который представляет собой <b>значковый шифр</b> пропорциональной замены, где гласным буквам ставилось в соответствие несколько знаков шифруемого алфавита, число  которых пропорционально частоте встречаемости буквы в открытом тексте.
Значковый шифр - это это простой шифр, заменяющий буквы на значки.
Миланский ключ - представитель класса шифров, которые называются “<b>омофонная замена</b>”
<b>Омофонная</b> (пропорциональная, частотная) замена — шифр подстановки, при котором каждый символ открытого текста заменяется на один из нескольких символов шифралфавита. Количество заменяющих символов для одной буквы пропорционально частоте этой буквы, что позволяет скрыть настоящую частоту появления данной буквы в зашифрованном тексте.
В 1401 г. Симеоне де Крема стал использовать таблицы омофонов для сокрытия частоты появления гласных букв в тексте при помощи более, чем одной шифрозамены.

При шифровании символ исходного сообщения заменяется на любую шифрозамену из своего столбца. Если символ встречается повторно, то используют разные шифрозамены.
В чем же преимущества омонной замены? Это очевидная защита против частотного анализа, так как при шифровании буквы исходного текста выбирается одна из её замен. При таком методе шифрования элементы шифртекста появляются равновероятно, поэтому обычный подсчет частоты встречаемости символов не дает никаких сведений.
Но в таком случае может помочь другой метод – учет закономерности соседства букв. Например, после буквы q в английском языке встречается только одна буква – u. Найдя символ, у которого справа имеется не более известного числа различных «соседей», можно установить замену для q и, как следствие, замены для u.

Важные особенности данного вида шифров:
 - Замены относятся к каждой конкретной букве. Это значит, что если у буквы «Ф» 3 замены, например, 100, 477 и 906, то замены 100, 477 и 906 обозначают только букву «Ф».
 - Омофонная замена – одноалфавитный шифр, так как алфавит зашифрования не меняется на протяжении всего процесса шифрования.Примеры многоалфавитных шифров мы рассмотрим позже.

<b>Известные примеры шифра омофонной замены:</b>
 - Зашифрованные сообщения известного серийного убийцы Зодиака зашифрованы шифром омофонной замены. Одно из двух сообщений до сих пор не расшифровано;

 - Мария Стюарт, королева Шотландии, держала личного шифровальщика, который вручал секретные послания ее сторонникам в то время, как сама она пребывала в заключении в Англии.
Но сторонники Елизаветы I, королевы Англии и политического противника Марии, сумели расшифровать тайные послания и предоставить суду доказательства заговора против Елизаветы, и позже Мария была казнена. Возможно, если бы шифр оказался более стойким, королева Шотландии осталась в живых.
Это - ещё один пример, когда от стойкости шифра зависела судьба государства и отдельных людей.

<b>Таблица Тритемия</b>
Иоганн Триметий, аббат монастыря Шпонхейм, живший в Германии в XV веке, предложил новаторский способ шифрования, построенный на основании периодически сдвигаемого ключа и названный впоследствии «Таблица Тритемия».
Его суть состоит в том, что замену для каждой буквы из алфавита берут из специальной таблицы, построенной следующим образом: каждая следующая строка берется со смещением на одну букву. Первая буква текста шифруется по первой строке, вторая – по второй и так далее, пока длина текста не превысит длину алфавита и шифрование снова не будет проводиться с первой строки.
Так слово apple приобретает вид «aqroi».

Преимущество данного метода перед шифром Альберти, описанным ранее, заключается в том, что для каждой буквы задействован новый алфавит, когда как Альберти менял алфавиты только после трех-четырёх слов. Поэтому шифртекст состоял из отрезков, каждый из которых обладал закономерностями открытого текста, которые помогали вскрыть криптограмму.
Данный шифр – первый нетривиальный пример периодического шифра. Так называется многоалфавитный шифр, правило зашифрования которого состоит в использовании периодически повторяющейся последовательности простых замен.
<i>Подробнее узнать о трактатах Альберти, Тритемия и других криптографов Среднего и раннего Нового времени, а также посмотреть на различные шифровальные диски можно в зале «Домашинная криптография» Музея криптографии.</i>


<b>Решетка Кардано</b>
В середине XVI века итальянский математик, врач и философ Дж. Кардано предлагает новый способ шифрования, названный впоследствии “решетка Кардано”. Для изготовления решетки брался квадратный лист из твердого материала(например, металл или бумага) и в нем проделывались отверстия.
Затем решетка прикладывалась к бумаге, а в “окна” выписывались буквы открытого текста. После использования всех “окон”, решетка поворачивалась на 90 градусов и процедура повторялась
<b>ПОЕЗД ОТХОДИТ В ТРИ</b>

<i>Больше узнать об этом шифре и попробовать расшифровать сообщения, в которых он использовался, вы можете в зале «Домашинная криптография» в Музее криптографии.</i>

<b>Использование пароля в шифровании</b>
Другим важным этапом в развитии криптографии стала концепция пароля для использования с многоалфавитными шифрами, предложенная в 1553 г. Джованни Баттиста Белазо.
Паролем могло служить слово или фраза. Пароль периодически записывался над открытым текстом. Буква пароля, расположенная над буквой текста, указывала на алфавит таблицы, который использовался для шифрования этой буквы.
Например, пароль мог использоваться с таблицей Тритемия.
Так, если паролем является слово ROI, то при расшифровывании слова FIGHT получаем WWOYH. Аналогичные идеи шифрования используются и сегодня.

<b>Шифр Порты</b>
Шифр Порты – первый известный биграммный шифр, который представляется в виде квадратной таблицы.
<b>Биграммный шифр</b> –  способ шифрования, когда каждому двухбуквенному сочетанию открытого текста в шифрованном тексте соответствовал специально придуманный знак. По сути, это шифр простой замены, но на уровне двухбуквенных сочетаний.

<b>Шифр Виженера</b>
Создание шифра Виженера стало важной вехой в развитии криптографии.Его суть заключается в том, что в процессе шифрования для букв открытого текста используются разные шифралфавиты, которые выбираются в соответствии с кодовым словом.
Таким образом, шифр Виженера, будучи многоалфавитным, был неуязвим для методов криптоанализа тех лет и многие годы считался невзламываемым.
Он был назван в честь Блеза Виженера, французского дипломата и криптографа. Виженер ознакомился с трудами Альберти, Порты, Тритемия и обобщил их идеи в шифр, который мы рассмотрим далее.

<b>Алгоритм шифрования с помощью шифра Виженера:</b>
1.Выбираем ключевое слово и записываем его под сообщением так, чтобы под каждой буквой сообщения находилась буква ключевого слова. Ключевое слово «протягиваем» до конца сообщения без повторов.
  Например, нам нужно передать сообщение «ATTACK TONIGHT» (пер. «Атака сегодня»). В качестве ключевого слова возьмем «DARK» (пер. «темнота»).

2.Используем следующую таблицу.
Находим пересечение строки с первой буквой ключевого слова и столбца с первой буквой сообщения. В нашем примере: строки с буквой D и столбца с буквой A в начале.
На пересечении находим букву D — первую букву зашифрованного сообщения.

3.Для второй буквы ищем пересечение строки с буквой A и столбца с буквой T:

4.Аналогичным способом зашифровываем все оставшиеся буквы сообщения. В итоге получаем: «DTKKFKKYQIXRW».
<i>Подробнее о шифре Виженера вы можете узнать в Музее криптографии в соответствующей инсталляции.</i>

<b>Шифр Бэкона</b>
Английский философ, историк, политик Фрэнсис Бэкон создал двухбуквенный шифр, называемый теперь шифром Бэкона. Шифр Бэкона имеет несколько методов использования.
1.Алфавитный метод. Английский алфавит во время Бэкона состоял из 24 букв. Каждую букву алфавита Бэкон предложил заменять на последовательность из букв A и B длины 5, так как последовательностью из пяти двоичных символов можно закодировать 2^5 = 32 символа.
Например, мы хотим зашифровать слово EAST. Букве E соответствует последовательность AABAA, букве A — AAAAA, букве S — BAAAB, букве T — BAABA. Получили: AABAA AAAAA BAAAB BAABA.

2.Циклические последовательности. Пусть имеется цепочка длины 32 из 5-буквенных последовательностей букв A и B, при этом последовательности не повторяются. Например: aaaaabbbbbabbbaabbababbaaababaab. Запишем её как цикл, соединив начало с концом.
Поставим в соответствие каждой букве из последовательности букву английского алфавита. Недостающие места заполним цифрами от 1 до 6. Теперь данная цепочка является ключом. Каждую букву будем кодировать пятеркой символов, начиная с этой буквы по часовой стрелке.
Рассмотрим пример для слова EAST. Букве E соответствует последовательность ABBBB, букве A — AAAAA, букве S — ABABB, букве T — BABBA. Получили: ABBBB AAAAA ABABB BABBA.

<b>Великий («дипломатический») шифр</b>
Антуан Россиньоль и его сын Бонавентур Россиньоль изобрели шифр, который использовал 587 различных числа. Шифр в течение многих столетий никто не мог взломать его, пока это не сделал Этьен Базери в 1893 году, который понял, что каждое число замещало французский слог, а не одну букву, как до этого считали. Он предположил, что специфическая последовательность повторных чисел, 124-22-125-46-345, кодирует слово «les ennemis» (враги), и, отталкиваясь от этой информации, он смог прочесть весь текст.

<b>Шифр Гронсфельда</b>
Шифр Гронсфельда – многоалфавитный шифр, созданный графом Гронсфельдом, руководителем специальной дешифровальной службы Германии в XVII веке.
Этот шифр – усовершенствованный шифр Виженера, где вместо буквенного пароля использовался числовой, а вместо громоздкой квадратной таблицы – намного меньшая и простая. Так называемая «таблица Гронсфельда» приведена ниже.

Ключ должен быть равен длине шифруемого сообщения, поэтому его циклически протягивают до необходимой длины. Например, нам необходимо зашифровать слово VICTORY, выбран ключ K=2016. Его длина должна быть равна 7, поэтому ключом будет являться последовательность 2016201.
Сопоставим каждой букве цифру из ключа:

Для первой буквы находим строку с цифрой 2 и столбец с буквой V. На их пересечении находится буква X.

Для второй буквы находим строку с цифрой 0 и столбец с буквой I. На их пересечении находится буква I.
Аналогичные действия проводим для остальных букв сообщения. Получаем шифртекст: XIDZQRZ.

<b>Шифр Плейфера (Уитстона)</b>
Этот шифр был создан английским физиком Чарльзом Уитстоном в 1854 году, но носит имя лорда Лайона Плейфера, способствовавшего применению этого способа шифрования к документам государственного уровня.
Для шифра Плейфера используется матрица 5x5 (так как в английском алфавите 26 букв, буква Q не используется). Выбирается ключ, который может быть записан либо слева направо сверху вниз, либо по спирали из левого верхнего угла в центр. Буквы в ключе записываются без повторений, остальные ячейки заполняются не использованными буквами в алфавитном порядке.
Например, возьмем в качестве ключа PLAYFAIR EXAMPLE. Тогда, с учетом уникальности букв, матрица будет выглядеть следующим образом:

Теперь необходимо разбить шифруемое сообщение на пары. Возьмем фразу HIDE THE GOLD IN THE TREE STUMP. Разбиваем буквы на пары, при этом, если в паре буквы совпадают или у буквы пары нет, то добавляем после первой буквы букву X. Итак, имеем HI DE TH EG OL DI NT HE TR EX ES TU MP.

Зашифрование производится по следующим правилам:
1.Если буквы находятся в разных столбцах и рядах, то они образуют диагональ прямоугольника. Например, рассмотрим пару букв HI. Они образуют диагональ, обозначенную красной стрелкой.
В случае, если буквы стоят в разных столбцах и рядах, они заменяются на буквы из тех же рядов, но соответствующих другой диагонали прямоугольника. В нашем примере буквы HI заменяются на BM.

2.Если буквы из пары оказываются в одном столбце, то они заменяются на буквы, находящиеся под каждой из них. При этом, если буква расположена в последнем ряду, то она заменяется на букву из первого ряда того же столбца.
Рассмотрим пару букв DE из примера. D заменяется на стоящую под ней N, E заменяется на стоящую под ней D. В итоге получаем ND.

3.Если буквы из пары оказываются в одном ряду, то они заменяются на буквы, находящиеся справа от каждой из них. При этом, если буква расположена в последнем столбце, то она заменяется на букву из первого столбца того же ряда.
Рассмотрим пару букв EX из примера. E заменяется на стоящую справа X, X заменяется на стоящую справа M. В итоге получаем XM.
Руководствуясь этими правилами, зашифруем все сообщение. Получили: BM ND ZB XD KY BE JV DM UI XM MN UV IF.


<b>Два квадрата</b>
Для шифра «Два квадрата» необходимо заполнить две матрицы буквами в произвольном порядке (порядок букв является ключом). Для русского алфавита рассмотрим следующий пример с матрицей 5x7:

Пусть мы хотим передать сообщение ПАРОЛЬ: КИНО. Разбиваем сообщение на биграммы: ПА РО ЛЬ :_(пробел) КИ НО. Алгоритм зашифрования имеет схожесть с алгоритмом шифра Плейфера (потому что автором обоих этих шифров является английский физик Чарльз Уитстон). В левом квадрате находим первую букву биграммы, в правом – вторую.
По диагоналям прямоугольника находим соответствующую паре ПА пару :У.

Паре букв РО соответствует пара букв ТБ.
Аналогично зашифровываем остальные биграммы.
Получаем «:УТБУЦХХЪРТЬ».

<b>Криптоанализ шифра Виженера. Метод Касиски и Бэббиджа.</b>
Метод криптоанализа шифра Виженера был разработан независимо офицером прусской армии, немецким шифровальщиком Фридрихом Касиски и английским математиком Чарльзом Бэббиджем.
Рассмотрим шифртекст, полученный с помощью шифра Виженера.

1.Отыскиваем в шифртексте повторяющиеся последовательности букв длины >= 4.

2.Считаем интервалы между повторяющимися последовательностями.

3.Каждый интервал между повторяющимися последовательностями разбиваем на множители.

4.Видим, что для интервалов между всеми повторяющимися последовательностями существует множитель 5. Предположим, что длина ключа равна 5. Найдем буквы, составляющие этот ключ.
5.Разбиваем шифртекст на 5 групп следующим образом: в первую часть вносим буквы под номерами 1, 6, 11, 16,... То есть буквы с номерами n mod 5 = 1; во вторую часть вносим буквы под номерами 2, 7, 12, 17,... То есть буквы с номерами n mod 5 = 2; в третью — 3, 8, 13, 18,... n mod 5 = 3; в четвертую — 4, 9, 14, 19,... n mod 5 = 4; в пятую — 4, 10, 15, 20,... n mod 5 = 5.
Например, в первую группу попадут следующие буквы:

6.Затем в каждой группе проводим частотный анализ. Так как каждая строка в квадрате Виженера представляет собой алфавит со сдвигом от 1 до 26, то, сделав в каждой группе частотный анализ и сопоставив его с частотной диаграммой алфавита, мы можем определить сдвиг в алфавите и каждую букву ключа.
Следуя этому алгоритму, мы получаем ключ EMILY.
Для дешифровки необходимо найти в ряду, начинающемся с соответствующей буквы ключа, букву из шифртекста, а затем посмотреть, какая буква стоит первой в этом столбце.
<i>Подробнее о методе Касиски и Бэббиджа вы можете узнать в Музее криптографии в инсталляции о Виженере.</i>

<b>Шифратор Джефферсона</b>
Шифратор Джефферсона состоит из 36 деревянных дисков, каждый из которых имеет 26 букв латинского алфавита, нанесенных в случайном порядке на его боковой поверхности.
Для зашифрования диски устанавливаются в задаваемом ключом порядке, затем поворачиваются так, чтобы открытый текст получился на одной из строк, идущих вдоль цилиндра. Для установки дисков в исходное положение используется подвижная линейка. Шифртекст отыскивается в другой строке при помощи линейки. В шифраторе Джефферсона – произвольной по выбору отправителя.
Неоднозначность в шифраторе Джефферсона сглаживалась низкой вероятностью появления другого осмысленного текста на остальных строках цилиндра.
<i>Попробовать зашифровать и расшифровать текст с помощью шифратора Джефферсона вы можете в Музее криптографии.</i>


С самых древних времен в России использовались системы шифрования. Например, применяли жаргонный код. Происходила замена слова/словосочетания на другое слово/словосочетание такая, что смысл передаваемого сообщения может понять только посвященный человек.
Например, условимся, что слово "болеть" означает быть под арестом, "доктор" – полиция, "больница" – тюрьма. Тогда открытый текст: "Иван арестован. Полиция отправляет его в тюрьму." можно представить в виде следующего шифртекста: "Иван заболел. Доктор отправляет его в больницу."

Также применялся шифр под названием “тарабарский язык”. В устное сообщение вставляли частицы-паразиты. Например, зашифруем сообщение: "Возьми суму." и получим: "Таравобаразьми тарасубараму."
Поросячья латынь по-русски представляла собой обобщение «тарабарского языка». После слога, содержащего гласную, добавляется слог с этой же гласной, но с постоянной согласной буквой.
Например, открытый текст: "У попа была собака, он её любил. Она съела кусок мяса, он её убил." и шифртекст: "Усу посопаса бысыласа сособасакаса, осон есеёсё люсюбисил. Осонаса съеселаса кусусосок мясясаса, осон есеёсё усубисил."

Также перед слогом, содержащим гласную, добавляли эту же гласную.
Например, зашифровав данное сообщение: "Корабли лавировали, лавировали, да не вылавировали.", получим: "Окоараибли алаивиороаваили, алаивиороаваили, ада ене ывыалаивиороаваили."
С древних времен до конца XVII в. основным средством шифрования на Руси были различные варианты шифра простой замены («иные письмена»).
Рассмотрим некоторые из них.
Знаки русского алфавита меняли на греческие, а позднее – латинские; Кроме того, делали замену на буквы мало распространенных на Руси алфавитов глаголицы и пермской азбуки.
Также знаки открытого текста могли менять на специально придуманные обозначения. Подобные шифры на Руси назывались «изменёнными кодами».

Основной системой шифрования на Руси являлась"литорея", которая имела две разновидности: "простая литорея" и "мудрая литорея". Для простой литореи свойственны следующие правила:
 - Гласные буквы, а также Й, Ь, Ъ оставались без изменений.
 - Выписывались в строку подряд все согласные в количестве 10 букв. Под этой строкой составлялась вторая строка из последующих 10 согласных, записанных в обратном порядке.
 - Буква из верхней строки заменялась на соответствующую букву из нижней, и наоборот.
<i>Расшифровать фразу, зашифрованную с помощью простой литореи, вы можете в Музее криптографии в зале «Протокриптография».</i>

При мудрой литореи замене уже подлежали все буквы алфавита, то есть это классический шифр простой замены.

«Хвиоть» («фиоть»)
Цифры и числа записывались с помощью букв кириллицы и греческого алфавита. Для указания, что буква означает цифру или число, а не звук, над ней ставился знак ~, который назывался «титло». Система основана на использовании букв, имеющих известное числовое значение. Такие буквы-числа для тайнописи раскладывались на слагаемые (обычно на два слагаемых). Например, число 4 можно зашифровать как буквой "д", так и сочетанием букв "вв".

Акростих – особая форма стихотворных текстов, где исходный открытый текст читался по буквам, стоящим на определенных позициях (чаще всего – в начале каждой строки). Если нужные буквы могут стоять где угодно в строке, то это «неправильный акростих».

 Тайнописная вязь – особый декоративный вид письма, связывающий строку в один непрерывный орнамент посредством объединения букв в лигатуры.

Первым из российских государей, понявших важность криптографии для безопасности страны, стал Петр I.
В это время пользовались популярностью шифры простой замены. Таблицу замены писали от руки на листе бумаги. Для усложнения могли помещаться «пустышки» – шифробозначения, которым не соответствует никакой знак открытого текста, а также было возможно наличие «суплемента» – словаря часто употребляемых слов/словосочетаний и их специальных обозначений.

<b>Разнозначная замена</b>
Для разнозначной замены характерны следующие признаки:
 - Длина шифробозначений не совпадает с длиной исходных символов.
 - Шифробозначения подбирались так, чтобы при расшифровке текста это не вызывало затруднений.
Таким образом, подобный шифр более стоек по сравнению с шифром простой замены, однако более чувствителен к ошибкам при шифровании.

При пропорциональной замене наиболее часто встречающиеся символы открытого текста имеют несколько шифробозначений.
Например, шифр А. Г. Головкина основан на такой замене, а именно:
 - Каждой согласной букве соответствует по одному шифробозначению, а гласным – по два.
 - 13 «пустышек».
 - Есть специальные обозначения для точек и запятых.

Интересным был блокнот с шифрами, которыми пользовался Петр I. Это была тетрадь, листы которой были скреплены веревкой. Размер тетради: 20 х 16 см. На каждой ее странице было записано по одному шифру, а всего их было шесть:
 - Шифр Петра I, который был ему прислан из Коллегии иностранных дел во Францию в 1720 г. для переписки «от двора ко двору»
 - Шифр «для писем к графу Г. и барону П.»
 - К князю Григорию Федоровичу Долгорукому
 - К князю А. И. Репнину (1715 г.)
 - «Азбука, которая была прислана от двора его царского величества при указе №…, а полученная 30 июля 1721 г.»
 - «Азбука цифирная, какову прислал Дмитрий Константинович Кантемир в 1721 г.»
Последний шифр с российским алфавитом отличался от предыдущих тем, что в качестве шифробозначений использовались не буквы алфавита, а числа.

В 30-е годы XVIII века появляются алфавитные и неалфавитные коды. В них словарные величины помещались в несколько разделов: алфавит, слоги, суплемент, счёты, месяцы. В качестве алфавита использовался либо русский, либо латинский. В качестве шифробозначения: арабские цифры. Гласным соответствовали несколько шифробозначений, а согласным –   одно-два. Записывали шифртекст без разделения точками либо с разделением фальшивыми точками. Шифробозначения выбирались всегда по определенным порядковым алфавитным схемам, что не способствовало надежности шифров.

 В 60-ых годах XVIII века разрабатывается направление, связанное с изменением значности шифробозначений. При зашифровании одного и того же сообщения часто пользовались разными языками (чаще всего русским и французским).
Все шифры снабжались подробными правилами их использования.
Русской разведке этого времени принадлежит идея активного использования контролируемых каналов шифрованной связи в целях получения информации о шифрах противника. Суть этой идеи состоит в следующем: лицо, контролирующее канал шифрованной связи, каким-либо способом побуждает одного из корреспондентов послать другому определенную информацию. Перехватив эту информацию в шифрованном виде и зная ее смысл, можно узнать ключ противника.
В XIX веке шифры стали делиться на общие и индивидуальные. Общие шифры предназначались для нескольких корреспондентов, как правило, расположенных в одном географическом регионе. Индивидуальные шифры предназначались исключительно для связи с центром.

В начале XIX века организовался цифирный комитет, задачей которого являлся анализ и введение новых систем шифров, контроль за их правильным использованием и хранением, вывод из действия устаревших или скомпрометированных шифров, составление заключений, отчетов и докладных для руководителей МИД и императора по вопросам деятельности шифровальной и дешифровальной службы.
Цифирный комитет устанавливал предельный срок действия каждого шифра в среднем от трех до шести лет. Но любопытно, что многие шифры использовались и по истечении их «срока годности», что, несомненно, сказывалось на тайне переписки. Кроме того, имели место серьёзные нарушения. Так, представлялось возможным снова использовать скомпрометированные шифры в других регионах или спустя некоторое время.

Например, русский биграммный ключ № 356 использовался почти 25 лет. Он был введен в действие в 1869г. «в консульствах на Востоке». В 1888 г. его экземпляр был украден из Российской миссии в Пекине. Вследствие этого шифр был выведен из употребления, но лишь на некоторое время. Несмотря на очевидность компрометации, шифр вновь ввели в действие, но уже в другом регионе. Он был направлен в Амстердам, Гаагу, Берн, Женеву,
Стокгольм и другие города. В 1898 г. произошла ещё одна компрометация этого шифра: один его экземпляр был потерян начальником Адриатической эскадры.
Вероятно, именно это событие заставило руководителей шифрслужбы окончательно изъять ключ №356 из употребления. В соответствующем заключении было указано: «вследствие почти 1/4-векового всемирного использования».

Русские дешифровальщики сыграли значительную роль в исходе Отечественной войны 1812 года и поражении Наполеоновской армии.
Наполеон пользовался двумя системами шифров:
 - «большой шифр» – для связи с командующими крупными военными формированиями, представлял собой код на 200 величин и был подобен «великому шифру» Россиньоля;
 - «малый шифр» – для переписки с небольшими армейскими подразделениями.
Александр I в своих воспоминаниях о войне лично цитировал переписку генералов Наполеона, в своё время дешифрованную российской криптографической службой.
«…нам очень сильно помогло то, что мы всегда знали намерения вашего императора из его же собственных депеш. Во время последних операций в стране были большие недовольства, и нам удалось захватить много депеш…» (Из разговора, состоявшегося после войны 1812 г. между Александром I и командующим одним из корпусов армии Наполеона маршалом Макдональдом.)

В биграммном шифре на каждую биграмму бралось 2 числа для шифрования. Причём шифровались не две рядом стоящие в открытом тексте буквы, а пара букв, разделенных некоторым заранее оговоренным расстоянием друг от друга. Открытый текст сначала переписывался в биграммы букв, находящихся на расстоянии 𝑇. Если длина открытого сообщения была не кратна 𝑇, то оно дополнялось произвольными знаками алфавита. Табличное задание правила шифрования биграмм напоминает биграммный шифр Порта. Кроме того, вводились «пустышки», предусматривалось шифрование отдельных знаков, дополнение открытого текста хаотическим набором знаков и др.
Позже стало ясно, что противнику известен принцип шифрования по данной системе, поэтому целесообразно было ввести некоторые изменения в шифр, а именно рекомендовалось уменьшить число букв латинского алфавита и знаков препинания в открытом тексте.

Во второй половине  XIX века также использовался биклавный шифр, шифрование происходит по следующему принципу:
 - Открытый текст дополнялся так, чтобы его длина была кратна 20, и разбивался на отрезки по 20 символов.
 - Всего на сутки выделялось 8 полосок.
 - Каждый отрезок шифровался по своей полоске. Если открытый текст превышал размер 20x8 символов, то процесс шифрования повторялся циклически.
 - Буквы полоски определяли столбец таблицы, а строки таблицы соответствовали символам открытого текста, на пересечении которых находился знак шифрованного текста

Кроме того, в этот период использовали коды, объём которых варьировался от 300 до 10 000 словарных величин, больше тысячи словарных величин – это слова, отражающие специфику переписки, которую предстояло шифровать с помощью этого кода, Около тысячи словарных величин приходилось на календарь, обозначение чисел, времени, другие специальные величины, имена собственные и географические наименования, а также имелись «пустышки».
Во второй половине XIX века произошло усложнение кодов. Использовалось несколько кодовых таблиц. Использовались лозунги (ключи). При зашифровании стандартные словосочетания, включая целые фразы, заменялись «постоянными» словами (для сокращения длины сообщения) и «переменными» (для дополнительного обеспечения секретности).

В XIX веке продолжается деятельность «черных кабинетов» при почтовых отделениях.
Выдающимся криптоаналитиком считается некий Иван Зыбин, умевший быстро и точно дешифровывать представленные ему шифртексты. В 1911 году благодаря его действиям удалось предотвратить покушение на Николая II.
Зыбин имел дело с шифрами простой замены, маршрутной перестановки, книжными шифрами.

<b>Агентурная сеть в период Русско-японской войны</b>
В конце XIX в. была создана сеть агентурной разведки против Японии.
У одного из российских агентов был осведомитель — немецкий подданный К.Э. Маукиш, переводчик китайского адмиралтейства. С его помощью добыты кодовые книги Японии, позволившие раскрыть планы Японии по завоеванию провинций Китая и Кореи.
До начала войны русской разведке удалось получить значительные сведения о состоянии дел в японской армии и на флоте и о подготовке Японии к войне. Для связи с агентурой использовалось шифрование, но в целом разведывательная служба России работала бессистемно.
В начале 1903 г. было образовано разведочного отделения главного штаба Российской Империи с целью противодействия иностранной разведке.

Во время войны шел оживленный обмен шифрованными сообщениями между Японией с одной стороны и Англией и Германией с другой. Использовался код, составленный на английском языке и имевший пять различных ключей.
В. И. Кривош-Неманич — специалист дешифровальной службы царской России — раскрыл три ключа.
Во Франции — она была союзницей России — раскрыли два ключа, один из которых был известен России. Последний ключ был раскрыт совместными усилиями специалистов обеих стран.

<b>Телеграфная связь в период Русско-японской войны</b>
Сразу после начала войны было учреждено почтово-телеграфное управление при главнокомандующем. Связь главнокомандующего вооружёнными силами на Дальнем Востоке с империей осуществлялась через центральное отделение телеграфа с помощью телеграфных аппаратов Уитстона.

Для связи главнокомандующего с армиями использовались буквопечатающие телеграфные аппараты Юза.
В июне 1904 г. учреждено телеграфное отделение, передвигающееся по железной дороге вслед за командующим и его штабом.
Впоследствии телеграфное отделение разделилось на два:
центральное телеграфное отделение;
телеграфное отделение при главнокомандующем.
Информация по телеграфу передавалась в открытом виде.
В 1904 г. японские спецслужбы начали применять схему дистанционного съёма информации с телеграфного столба.
В 1915 г. в российской прессе прошло сообщение о том, что в период Русско-японской войны были случаи перехвата японцами телеграфных сообщений.

<b>Радио в период Русско-японской войны</b>
К преимуществам радио относились:
 - быстрота установления связи (в то время — до 40 минут);
 - возможность организации связи через недоступные пространства и занятые противником территории.
К марту 1904 г. почти все корабли были оснащены радиостанциями.
В апреле 1905 г. сформированы в Петербурге 1-я и 2-я восточно-сибирские искровые (радиотелеграфные) роты, имевшие на вооружении по 8 радиостанций «Маркони».
<i>Узнать об истории дореволюционной отечественной криптографии и российских криптографических служб можно в «Зале славы отечественной криптографии», зале «Домашинная криптография» и инсталляции «История шифровальных служб» в Музее криптографии.</i>


Криптография сыграла особую роль во время Гражданской войны в США(1861-1865) из-за особенностей этого конфликта:
 - В армиях присутствовали подразделения разведчиков, постоянно наблюдавших за противником, а также шпионы.
 - Армейские подразделения и населенные пункты были связаны телеграфом, который позволял мгновенно передавать сообщения на большие расстояния.
 - Сообщение, передаваемые с помощью телеграфа, могли быть легко перехвачены противником, в связи с чем возникла необходимость передавать их в зашифрованном виде.
 - Телеграфные сообщение противника можно было перехватить и предпринять попытку их криптоанализа.
 - В армиях и столицах враждующих государств были созданы криптографические и криптоаналитические подразделения и службы
 - Преимущество получала сторона, использующая более надежное шифрование.

Ранние шифры Севера и Юга включали:
 - <b>Шифр Цезаря(с переменным сдвигом)</b>
 - <b>“Масонский” шифр</b>
Этот шифр представляет собой шифр простой подстановки, в котором каждой букве ставится в соответствие фрагменты сетки.

 - <b>шифр Рельсовый забор;</b>
Это шифр перестановки, смысл которого заключался в том, что открытый текст записывают зигзагом на «рельсы», чтобы потом соединить их построчно.
Ниже приведен пример его использования:

 - <b>шифр для азбуки Морзе (шифр Стейджера);</b>
В 1861 г. Ансон Стейджер, глава Отдела военного телеграфа США, предложил шифр, предназначенный для передачи информации по телеграфу азбукой Морзе. Имеет 2 способа шифрования, которые в различных версиях могут применяться вместе или по отдельности:
1.код, то есть замена важных слов (географические названия, имена, даты, часто встречающиеся слова) на другие слова.Например, имя «Авраам Линкольн» заменялось на «Адриан», «противник» на «деревня» и т. д. Этот способ имел преимущество перед другими шифрами, где передаваемое сообщение представляло собой хаотичный набор букв, так как телеграфисты, имея возможность читать и понимать передаваемое сообщение, были склонны совершать меньше ошибок, что значительно упрощало процесс дешифрования;

2.на уровне слов сообщение зашифровывается методом маршрутной перестановки. В начале сообщения передается кодовое слово, которое сообщает получателю, какой маршрут для выписывания слов сообщения из таблицы он должен применить.
Пример использования шифра Стейджера:

 - <b>шифр для передачи флажками</b>
В годы гражданской войны в США обе стороны создали систему передачи сообщений при помощи сигналов флажками, которые обозначали буквы.
Поскольку противник мог осуществлять перехват таких сообщений, каждая из сторон создала несколько вариантов алфавита для фиксированного набора сигналов флажками.
Пример используемого алфавита:

Поскольку противник мог перехватывать сообщения и, возможно, осуществлять их криптоанализ, было принято решение регулярно менять шифробозначение каждой буквы, а для простоты создания алфавитов замены использовать диск, задающий обозначение каждой из букв.
<i>Шифровальный диск конфедератов представлен в коллекции музея криптографии в зале  «Домашинная криптография»</i>
В ходе войны обе стороны осознали слабости простых шифров и стали использовать считавшийся на начало войны невзламываемым шифр Виженера, используя в качестве ключа фразы из нескольких слов.
Армия Конфедерации (Юг) разработала диск, позволявший несколько автоматизировать зашифрование.

Из мемуаров капитана Кэмпбелла Брауна, офицера штаба генерала Джозефа Эгглстона Джонстона:
<i>“Полковник Бенджамин Эвелл научил меня шифру и сообщил пароль (или ключевое слово) для чтения депеш, которые прибывали. Я расшифровал почти все сообщения от генерала Джона Пембертона и Военного министерства с 1 марта по 1 мая 1863 года и зашифровал большинство ответов. Система заключалась в том, чтобы зашифровывать только самые важные слова сообщения – и иногда некоторые маловажные, чтобы ввести противника в заблуждение – чтобы предотвратить распознавание. Я, конечно, могу уже упомянуть ключевое слово, которое использовалось. Это была фраза «Манчестерский блеф». Система, названия которой я не знаю, была основана на принципе «асимптот гиперболы». Расшифрование было утомительной работой, а шифрование - не менее трудоемким.“</i>

В 1863 году Фридрих Касиски публикует книгу «Тайнопись и искусство дешифрирования», в которой описывает метод взлома шифра Виженера, независимо разработанный им и Чарльзом Бэббиджем.
Таким образом, шифр Виженера становится ненадежным даже при правильном применении.
Однако, даже если бы не открытие Бэббиджа-Касиски, шифр не обеспечивал бы достаточную надежность шифрования, поскольку использовался с ошибками.
Из мемуаров капитана Кэмпбелла Брауна, описание эпизода, когда Брауну было поручено расшифровать депешу генерала Пембертона:
<i>“Никогда в жизни не знал я такой глупости, как та, что продемонстрировал тогда Пембертон. Я помню, как расшифровал очень длинную шифрованную депешу от него, настолько не содержащую ничего важного и нелепую, что полковник Эвелл заявил, что я, разумеется, допустил ошибку. Мы проверили еще раз – я все же был прав.”</i>

В другом случае во время боевых действий генерал Джонстон отправил зашифрованное сообщение генералу Эдмунду Кирби Смиту. После 12 часов безуспешных попыток расшифровать сообщение, Кирби Смит в конце концов отправил к Джонстону посыльного офицера, чтобы выяснить его содержание. Сообщение было просьбой о подкреплении, но к тому моменту, как посыльный доложил об этом генералу Кирби Смиту, было уже поздно.
Кроме того, за все время войны с 1861 по 1865 год Конфедераты (Юг), по некоторым сведениям, использовали всего 3 различных ключа, которые довольно быстро стали известны северянам:
 - Manchester Bluff
 - Come Retribution
 - Complete Victory

В 1883 была опубликована книга великого английского криптографа Керкгоффса «Военная криптография», фундаментальный труд важный для развития криптографии.
В ней Керкгоффс сформулировал 6 требуемых <b>свойств военной криптографии</b>:
 - система должна быть физически, если не математически, невзламываемой;
 - сама система не должна быть секретной, а ее попадание в руки противника не должно вызывать никаких неудобств;
 - ключ должен быть пригодным для передачи и хранения без каких-либо записей, а также для изменения и модификации по желанию корреспондентов;
 - система должна быть пригодна для передачи сообщений по телеграфу;
 - система должна быть портативной и не требовать дополнительного персонала для ее обслуживания;
 - система должна быть простой и не требовать от пользователя ни существенных умственных усилий ни знания большого перечня правил использования.

<b>Шифры Биля</b>
В 1885 году была опубликована брошюра под названием «Бумаги Биля», которая содержала 3 шифртекста, авторство которых приписывается некоему Томасу Билю.
В предисловии утверждалось, что зашифрованные тексты содержат следующую информацию:
 - местонахождение клада огромной стоимости;
 - подробную опись спрятанных сокровищ;
 - имена тех, кому автор текстов завещал передать сокровища в случае их обнаружения.
Шифры Биля являются одним из наиболее известных примеров использования книжного шифра. Единственный расшифрованный шифр Биля основан на одной из редких печатных версий Декларации независимости США.

Криптограмма №2, в которой было указано содержимое тайника, была дешифрована следующим образом: автор брошюры предположил, что Билем был использован книжный шифр. Перебирая «популярные» в то время книги, он пронумеровал слова в каждой из них, а затем в соответствии с числами, указанными в криптограмме Биля, подставлял первые буквы слов под этими номерами. Декларация независимости США оказалась ключом для данной криптограммы.
Дешифрованный текст начинается так: <i>«I have deposited in the county of Bedford, about four miles from Buford, in an excavation or vault, six feet below the surface of the ground, the following articles belonging jointly to the parties whose names are given in number three herewith»</i>.

<b>Вопрос стойкости шифров</b>
До третьей четверти XIX в. оценка стойкости шифров проводилась самими авторами шифров. В качестве доказательств стойкости приводились такие аргументы как:
 - объем времени, необходимый для перебора всех возможных ключей;
 - математическая стойкость обращения какой-либо составляющей операции зашифрования;
 - сложность ключа;
 - неудачные попытки взлома шифра ближайшими знакомыми автора;
 - аналогичные результаты при попытках взлома людьми, имеющими образование в смежных областях (лингвистика, математика и т.д.)
Тезис о том, что проводить анализ стойкости шифров должны только профессиональные криптоаналитики, был озвучен в книге «Военная криптография» О. Керкгоффса.

<b>Этьен Базери</b>
Одним из известных французских криптоаналитиков является Этьен Базери. С 1891 по 1899 гг. он являлся сотрудником МИД Франции и проводил дешифрование шифрованной переписки в интересах МИД и МВД. К заслугам Базери относятся осуществление криптоанализа ряда исторических шифров (в том числе «Великого шифра» Россиньоля), дешифровка и реконструкция «Малого шифра Наполеона», выдвижение версии разгадки «Тайны железной маски».
В 1901 году была опубликована книга Этьена Базери «Раскрытые секретные шифры», на обложке которой был изображен «цилиндр Базери».
Цилиндр Базери представляет собой упрощенный аналог цилиндра Джефферсона: 20
дисков вместо 36, порядок букв не являлся секретным и для простоты запоминания он легко образовывался из фраз-лозунгов. Но цилиндр не был принят французской армией в связи с простотой вскрытия шифра.

<b>Дело Дрейфуса</b>
15 октября 1894 г. был произведен арест капитана французского генерального штаба А. Дрейфуса по обвинению в шпионаже в пользу стран Тройственного союза (Германии или Италии). Основой обвинения послужило сходство почерка Дрейфуса с почерком неизвестного автора, разгласившего в рукописном документе военные секреты Франции.

Примерно через 2 недели военный атташе Италии отправляет в Рим зашифрованную телеграмму. Телеграмма скопирована на парижском телеграфе и передана в МИД.
По предположению сотрудников криптографического бюро МИДа, использовался итальянский коммерческий код Паоло Баравелли «Словарь для шифрованной переписки», состоящий из 4 таблиц замены:
 - гласные и знаки препинания кодируются цифрами от 0 до 9;
 - согласные и некоторые глаголы — парами цифр;
 - слоги — тройками цифр;
 - слова и фразы — четверками цифр, некоторые четырехзначные группы пустые: для заполнения абонентами.
Предположив, что в телеграмме имеется слово «Дрейфус», уже на следующий день криптоаналитики получили примерный текст телеграммы: «…арестован… капитан Дрейфус, который не был в сношениях с Германией…»

Еще через несколько дней текст был уточнен: «Если капитан Дрейфус не состоял в сношениях с вами, было бы целесообразно… сделать официальное опровержение… Наш агент предупреждён».
Еще через несколько дней появился окончательный вариант текста: «Если капитан Дрейфус не состоял в сношениях с вами, было бы целесообразно поручить послу сделать официальное опровержение, чтобы избежать комментариев в печати». Для проверки правильности дешифрования была организована передача итальянскому атташе сведений о некоем офицере, перевозящем мобилизационные документы французской армии.

Итальянский атташе немедленно передает сведения в Рим, практически не изменив текста сообщения от своего информатора, а также применив тот же шифр, что и для дешифруемой телеграммы. Как и в случае с первой телеграммой, криптоаналитики МИДа получили её копию и провели её дешифрование.  Текст был представлен в военную разведку и почти дословно совпал с хранящимся там оригиналом, что подтвердило правильность работы дешифровальщиков.
По политическим мотивам невиновность Дрейфуса была неприемлемым результатом суда для некоторых лиц, поэтому была сфабрикована новая телеграмма, имевшая текст «Капитан Дрейфус арестован, военный министр имеет доказательства его связи с Германией. Заинтересованные лица информированы под большим секретом. Мой агент предупреждён». Изобличить подделку можно по несоответствиям в шифртексте и открытом тексте, что привело к повторному дешифрованию телеграммы в 1899 году, когда был обнародован подлинный её текст.

<b>Криптоанализ в литературе</b>
В рассказе «Золотой жук» Эдгара Аллана По 1843 года приведены этапы частотного анализа.
В цикле рассказов о сыщике Шерлоке Холмсе Артура Конан Дойла два эпизода содержат упоминания криптоанализа, проведенного сыщиком:
 - «Пляшущие человечки» —  1905 г., сообщения преступника из Америки зашифрованы шифром простой замены с помощью фигур пляшущих человечков;
 - «Долина страха» — 1914 г., записка от профессора Мориарти написана при помощи книжного шифра.
<i>Узнать больше примеров использования криптографии в художественных текстах вы можете в Музее криптографии в разделе «Книжная полка».</i>


Первая мировая война оказала значительное влияние на развитие криптографии. Рассмотрим, как в каждой из центральных держав применялась криптография.

В <b>Германии</b> в начале войны в войсках использовались шифры XIX века, не всегда отвечающие  принципам Керкгоффса. Дешифрование шифров противника осуществлялось на уровне дивизий и армий.
Единое дешифровальное бюро «Abhorchdienst» («Служба подслушивания») было создано в 1916 году по следующим возможным причинам:
 - на западном фронте не было значительного объема перехватываемых сообщений;
 - на восточном фронте шифры противника взламывались на уровне дивизий или при помощи австрийских дешифровальщиков.

С 1914 года самостоятельно или при помощи дешифровальной службы Австро-Венгрии успешно велось дешифрование сообщений (особенно передаваемых по радио) русской армии. Одной из криптоаналитических групп руководил профессор филологии Кенигсбергского университета Людвиг Дойбнер.
В марте/июне 1918 года Германия вводит в действие новый шифр <b>ADFGX</b> и <b>ADFGVX</b>. Он представляет собой сочетание простой замены и маршрутной перестановки
На первом этапе алфавит размещается в клетках таблицы размером 5х5 (буквы I и J отождествляются) или 6х6 и шифруются по принципу квадрата Полибия. Каждый символ шифруется парой букв, обозначающих строку и столбец позиции буквы в таблице (аналогично квадрату Полибия).

Рассмотрим пример. Пусть нам надо зашифровать следующее предложение: "Attack at 10 pm"

Далее реализуется лозунговая перестановка на основе ключа. Возьмем в качестве ключа слово "MARS" и применим лозунговую перестановку.

Окончательный текст шифра выписывается по столбцам слева направо, в каждом столбце сверху вниз. В нашем примере, мы получим зашифрованное сообщение: "V D G V V D D D F D A A D D F D X G D V D D G X"

Далее рассмотрим <b>Австро-Венгрию</b>. Капитан Герман Покорный принёс заметный успех благодаря дешифрованию российских шифров на протяжении всей войны. Для дешифрования текстов, зашифрованных с помощью кода, использовались предположения о вероятных словах таких, как «атака», «дивизия» и т. д.
В сентябре 1914 года Покорным была прочитана первая шифрованная телеграмма, содержавшая решение русского генерала Новикова: «Я принял решение не форсировать вислу». Знание этого решения, сообщенное австрийцами своим союзникам, обеспечило успех сил центральных держав на начальном этапе битвы на Висле.

Во <b>Франции</b> основным используемым шифром была «Таблица согласования» (Tableau de Concordance). К началу I Мировой войны страна имела сильную команду криптоаналитиков, готовых к взлому шифров противника. Использовались станции перехвата радиосообщений, позволяющие определять место, из которого ведется передача, а также французские специалисты по радиоперехвату научились опознавать радиотелеграфистов по «почерку».
Этьен Базери вернулся к активной работе по взлому немецких шифров. Один из наиболее выдающихся результатов – взлом шифра  ADFGX/ADFGVX в 1918 году, связываемый с именем французского лейтенанта Жоржа Пэйнвина.

Основной дипломатический шифр Франции в годы I Мировой войны «Таблица согласования» трижды менялся за период с 1 августа 1914 года по 15 января 1915 года.
Он представлял собой несколько этапов зашифрования:
1.Каждое слово шифруемого сообщения заменялось на основе кодовой книги на группу из 4 цифр. Например, «Атакуйте немедленно» - «1914», «1915»
2.Каждые 4 цифры разделялись на 3 группы: 1 цифра, 2 цифры и 1 цифра. В нашем примере – «1», «91» и «4», «1», «91» и «5»;
3.Полученные группы сцеплялись в одну строку, кроме первой и последней групп. В нашем примере – «1», «91», «41», «91», «5»;
4.Каждая группа из 2 цифр (а также и первая и последняя группы по 1 цифре) заменяются на пары букв по кодовой таблице;
5.Полученные буквы сцепляются в одну строку без пробелов.

При анализе шифра ADFGX/ADFGVX для опредения длины ключа перестановки использовался аналог теста Касиски на основе повторяющихся фрагментов шифртекста.
Пэйнвин заметил, что если длина ключа четная, то каждая колонка в перестановке состоит либо из букв, нумерующих столбцы, либо из букв, нумерующих строки, но не тех и других вместе.
Хотя частотный анализ в чистом виде был невозможен, оказалось возможным провести частотный анализ букв, исходя из того, координаты каких букв они обозначают.

В таблице замены каждая буква, стоящая в заголовке строки или столбца, задает координаты 6 символов (Пэйнвин начинал работу с шифром ADFGX, где цифр в таблице не было).
Например, буква А, как заголовок строки, связана с символами «8», «p», «3», «d», «l», «n». Вероятно, не самая частая строка.
Буква D, как заголовок строки, связана с символами «1», «t», «4», «o», «a», «h». Вероятно, наиболее частая строка – буквы «t», «a» и «o» – 2, 3 и 4 по частоте.

Разделив буквы шифртекста на координаты строк и координаты столбцов, можно сравнить суммарные частоты наборов букв для каждой строки и каждого столбца.
Такой анализ был проведен Пэйнвином вручную, примерно с марта 1918 года по 2 июня, так что усовершенствованный шифр был взломан им едва ли не через 2 дня.
Одной из важных телеграмм, которые Пэйнвину удалось прочесть, была телеграмма, содержавшая текст: «Боеприпасы для стремительного наступления. Даже днем, если не видно».
На основе данного текста французы, ожидавшие решающего наступления германской армии на Париж, но не знавшие его точного направления и места, откуда начнется удар, смогли, используя станции радиоперехвата, определить, где собираются немецкие силы, и, вовремя перебросив туда резервы, сорвать наступление.

В соответствии с планом ведения разведки и перехвата немецких сообщений, в самом начале войны <b>Великобритания</b> перерезала немецкие трансатлантические кабели, что заставило Германию использовать для связи через океан либо радиосвязь либо кабели других государств, часть которых в нейтральных государствах контролировались британской разведкой.
В 1914 году Великобритания, по инициативе Альфреда Юинга, занимавшегося в Британском Адмиралтействе вопросами военно-морской подготовки, создала службу дешифрования при Британском Адмиралтействе – так называемую «Комнату 40».
Юинг стал инициатором дешифрования получаемых немецких шифрованных сообщений, особенно после того, как русский флот захватил с немецкого крейсера «Магдебург» кодовые книги ВМС Германии.

Первоначально группа Юинга собиралась в его кабинете, однако когда сотрудников  стало слишком много, а интенсивность работы стала мешать Юингу принимать посетителей по своим непосредственным обязанностям, криптоаналитики перебрались в большую комнату №40. Всего было расшифровано около 15 000 немецких сообщений.
«Комната 40» успешно взламывала шифры Германии и ее союзников. Наиболее крупный успех – взлом зашифрованной телеграммы министра иностранных дел Германии Артура Циммермана. Взломанные шифры также использовались для дезинформации противника.

Телеграмма Артура Циммермана – министра иностранных дел Германии, была отправлена в 1917 году германскому послу в Вашингтоне. Суть телеграммы – план по привлечению Мексики к вступлению в войну на стороне Центральных держав в случае, если США поддержит Антанту. Посол в США должен был, удалив часть текста, переслать дальнейшие инструкции послу Германии в Мексике. Мексике предлагалось при поддержке Германии напасть на США и, после их капитуляции, Германия бралась отстаивать право Мексики на присоединение ранее утраченных ей штатов.

После дешифрования телеграммы Циммермана требовалось не подвергнуть опасности работы «Комнаты 40», поскольку ее громкий успех привел бы к смене шифров Германией.
Уже после того, как телеграмма была дешифрована, английскому агенту в Мексике было поручено достать вариант телеграммы, переданный послом в США послу в Мексике. Этот-то вариант в дешифрованном виде и был широко обнародован и опубликован в газетах. Почти одновременно были инспирированы статьи с нападками в адрес «Комнаты 40», сотрудники которой якобы не смогли перехватить и дешифровать телеграмму,  отправленную самим Циммерманом.
Еще ранее в 1914 году британский агент в Берлине отправил одному из немецких адмиралов поддельный приказ, зашифрованный шифром морского министерства Германии с корректным ключом. В результате немецкая эскадра была застигнута врасплох английскими линкорами и уничтожена.
<i>Увидеть текст перехваченной телеграммы Циммермана и послушать о ее истории можно в зале «Криптография в индустриальную эпоху» Музея криптографии.</i>

На начальном этапе войны криптографическая служба <b>русской</b> армии была организована неудовлетворительно, что привело к поражениям 1914 года. В дальнейшем ситуация была исправлена, но используемые шифры оставались слабыми. Русская разведка успешно добывала кодовые книги германской армии и флота, что позволяло читать некоторую часть переписки противника. Самый известный успех – подъем кодовых книг германских ВМС с крейсера «Магдебург» в 1914 году.

На начальном этапе войны российская армия была не готова к передаче зашифрованных сообщений.
Накануне войны русской разведке удалось получить планы генштаба Австро-Венгрии, шантажируя начальника военной контрразведки полковника Альфреда Редля. Опасаясь, что аналогичная операция может быть проведена разведками потенциального противника, командование русских войск до последнего момента тянуло с введением в войсках новых шифров и рассылкой ключей к ним.
В результате до решения этой проблемы часть соединений вела переговоры по радио открытым текстом («клером»). Организации надежной проводной связи мешал ограниченный запас кабеля и в некоторых случаях характер местности. Самый известный провал, связанный с такими обстоятельствами – поражение армий Самсонова и Ренненкампфа в Восточной Пруссии .

В сентябре 1914 года в российские войска поступили шифровальные средства.  Используемый шифр представлял собой код, основанный на замене символов открытого текста цифровыми группами по таблице. В таблице имелось 8 строк, порядок использования которых был регламентирован – строки использовались поочередно для группы знаков произвольной длины, определяемой шифровальщиком, так что сами строки являлись ключом шифра. В заголовке сообщения пять раз проставлялось число знаков, которые были зашифрованы каждой строкой. Допускалось изменение этого значения по ходу шифрования – тогда в тексте сообщения также пятикратно повторялось новое значение этого параметра.

К октябрю 1914 года порядок использования шифралфавитов был признан частью ключа и менялся ежедневно. 20 октября 1914 года раскрытие шифра было обнаружено и сами строки таблицы были заменены.
Весной 1915 года русская армия отказалась от прежнего шифра и стала использовать шифр Цезаря. Причиной такого упрощения называется излишняя сложность для криптографов, которую устанавливал шифр с часто меняющимся порядком использования строк таблиц и большое количество самих таблиц, по которым должно было проводиться зашифрование, в условиях боевых действий

В 1916 году под влиянием роста уверенности, что противник читает шифрованные сообщения русской армии, был введен шифр на основе кодовой книги. Однако резко снижающийся уровень подготовки и дисциплины шифровальщиков не позволил обеспечить секретность переписки между соединениями и штабами.
Русский флот действовал в шифровальном деле гораздо успешнее армии. С начала 1915 года в Балтийском и Черном морях были созданы станции радиоперехвата, снабжавшие командование русского флота немецкими и турецкими шифрованными радиотелеграммами. Несмотря на неоднократную смену ключей (правда, без изменения основ системы шифрования), полученные сообщения вскрывались русскими криптоаналитиками.

В самом начале войны – в августе 1914 года русскому флоту удалось захватить в плен остатки команды потерпевшего крушение крейсера «Магдебург». Среди погибших был обнаружен офицер корабля, держащий кодовую книгу немецкого ВМФ. После этого с корабля были изъяты остальные документы, а русская разведка провела операцию по дезинформации противника, убедившая его в том, что кодовые книги уничтожены.
По воспоминаниям Уинстона Черчилля, полученное им сообщение из Петрограда уведомляло, «что с помощью кодовых книг русское Адмиралтейство в состоянии дешифровать по меньшей мере определенные части немецких военно-морских шифртелеграмм».

Было явно продемонстрировано превосходство криптоаналитиков над криптографами, использующими прежние шифры, даже в сочетании друг с другом (например, замена + перестановка или код + различные приемы запутывания).
Стало ясно, что действующие вручную шифровальщики не справляются с потоком шифруемой информации, допускают ошибки, не успевают оперативно менять ключи для сложных шифров.

В <b>США</b> в конце войны были высказаны предположения о возможности построить не поддающийся взлому шифр, основанный на шифре Виженера, ключ которого был бы достаточно длинным (чтобы не допускать частотного анализа частей текста) и не содержал бы структур. Майором армии США Джозефом Моборном введено понятие «случайного ключа» - ключа, состоящего из случайно комбинации букв.
Начались исследования по возможности создания таких ключей и создания одноразовых блокнотов с такими ключами – «шифроблокнотов» или «одноразовых  блокнотов».


Автоматизация шифрования
Опыт Первой мировой показал, что существующий подход к криптографии имеет ряд недостатков и требует изменений:
 - Одноалфавитные шифры и шифры маршрутной перестановки почти неизбежно взламываются криптоаналитиками.
 - Требуется использование многоалфавитных шифров.
 - Из-за возросшего объема передаваемой информации необходима механизация шифрования.

<b>M-94</b>
В 1917 г. полковник армии США Джозеф Моборн разработал шифровальное устройство М-94, который является независимой разработкой идеи шифратора Джефферсона, о котором было рассказано ранее.
Он состоит из 25 алюминиевых дисков, каждый из которых содержит смешанный латинский алфавит. Диски имеют обозначения по букве, следующей за буквой «А» от «B 1» до «Z 25».

Ключом являлось порядок расположения дисков. Для шифрования оператор выравнивал буквы открытого текста по горизонтали. В качестве зашифрованного текста отправлялись любые другие строки. Для дешифрования колеса поворачивали до тех пор, пока одна строка не совпадала с 25-буквенным блоком зашифрованного текста, а открытый текст появлялся в одной из других строк, которая единственная могла “читаться” (была осмысленной).
Это полностью механическое устройство, которое реализует шифр многоалфавитной замены с ключом длиной 25 символов.
Несмотря на то, что шифр, реализуемый с помощью M-94, уязвим для теста Касиски, он использовался на тактическом уровне с 1922 г. до 1943 г.

Основой многих шифровальных машин XX века, был шифровальный диск (ротор) – диск из изоляционного материала, содержащий контакты с обеих сторон, соединенные внутри диска попарно в произвольном порядке. Реализует простую замену - контакт, отвечающий за определенную букву, был соединен с контактом на другой стороне, отвечающим уже за другую букву.
Сам по себе шифр, реализуемый шифровальный диск, довольно прост, но он предназначен для совместного использования с другими дисками, вращающимися относительно друг друга по определенному алгоритму для реализации шифра многоалфавитной замены с длинным ключом, задаваемым начальным положением и порядком вращения дисков.

Первые дисковые шифровальные машины были разработаны во время Первой мировой, но долгое время оставались засекреченными. Самой ранней известной на данный момент шифровальной машиной является устройство разработки голландских инженеров Тео ван Хенгеля и Рудольфа Шпенглера, которая использовалась в 1915-1917 годах на голландском флоте. Первый патент на дисковую шифровальную машину получил американец Эдвард Хеберн..
Первая модель шифровальной машины Хеберна использовала только один шифровальный диск, но в дальнейшем количество используемых дисков увеличилось. Для расшифрования требовалось вынуть диск  и перевернуть его.
<i>Увидеть копию этой машины вы можете в Музее криптографии в зале «Механическое сердце».</i>

В 1920-х Александр фон Крихе, немец украинского происхождения, создал шифровальную машину, которая являлась полностью механическом устройством.
Она состоит из диска и кольца, содержащих смешанные латинские алфавиты, при этом буква открытого текста отыскивается в одном из алфавитов (как правило, внешнем), а буква шифртекста – в другом алфавите (как правило, внутреннем). Перед шифрованием следующего знака открытого текста производится нажатие рычага, который поворачивает внутренний диск на некоторое количество позиций. Количество позиций зависит от выбранного диска, содержащего некоторое количество зубцов, и его текущего положения.
Реализует шифр многоалфавитной замены со сложным псевдослучайным порядком выбора алфавитов.
<i>В коллекции Музея криптографии представлено оригинальное шифровальное устройство  —  «Криха-лиллипут» 1924 года производства, в разделе «Домашинная криптография».</i>

Альтернатива шифровальным дискам, вращающим друг друга – система штырей и выступов (pin-and-lug), применяемая наиболее широко в машинах Хагелина,  семействе шифровальных машин, разработанных Борисом Хагелином или под его руководством.
По мере работы системы несколько дисков, снабженных выступами (pins), число и расположение которых в некоторых машинах можно менять, периодически цепляются выступающими деталями (lugs), благодаря чему происходит вращение дисков – независимое или влияющее друг на друга.
Движение дисков и процесс зашифрования таким образом являются чисто механическим процессом, не требующим электрического питания, хотя к некоторым устройствам Хагелина добавлялись электрические элементы, например клавиатура или телеграфный трансмиттер.
<i>В коллекции Музея криптографии, в зале «Механическое сердце» представлено два устройства, произведенные в компании Бориса Хагелина  —  CX-52 и CD-57.</i>

Мы переходим к по-настоящему легендарной шифровальной машине “Энигма”, которая активно использовалась во время Второй мировой войны в гитлеровской Германии.
Создатель Энигмы, Артур Шербиус, - немецкий инженер, изучал электротехнику в техническом университете Мюнхена, защитил диссертацию, став доктором инженерных наук около 1904 года.
Работал на ряд компаний, занимающихся электрическим оборудованием в Германии и Швейцарии до 1918 года, а в 1918 стал сооснователем фирмы «Шербиус и Риттер», занимавшейся всевозможными электроприборами.В том же году подал первую заявку на патент на роторную шифровальную машину.

“Энигма”, чья первая коммерческая версия была представлена в 1923 году, в течение следующих 20 лет претерпела множество конструкторских изменений, далеко не сразу став классической и наиболее известной версией шифровальной машинки.
<i>В Музее криптографии вы можете самостоятельно зашифровать сообщение с помощью симулятора “Энигмы” и увидеть оригинальную машину.</i>

В основе “Энигмы” лежали шифровальные диски. В разных моделях количество используемых дисков менялось, например, если в первой версии их было всего 3, когда как в более поздних моделях их количество выросло до 8, а версия “Kriegsmarine M4” также требовала ротор особой группы - Бета или Гамма.
Таблица внутренних перепаек роторов приведена ниже.

Движение дисков осуществлялось по принципу ротора, или часовых стрелок  — первый диск совершал шаг при каждом нажатии на клавишу, а когда он совершал полный оборот, то при помощи специального зубца зацеплял соседний с ним диск, и тот совершал один шаг. В свою очередь, когда второй диск совершал полный оборот, он зацеплял крайний, самый медленный диск. Передача вращения от одного диска к другому осуществлялась с помощью ступенчатого механизма - системы храповиков (шестеренок с зубцами) и собачек, которые выдвигались вперед при каждом нажатии клавиши машинки. Если собачка цепляла зубец шестеренки, то диск поворачивался на один шаг.

В модели Enigma C(1924) был использован рефлектор -  неподвижный ротор, в котором подпружиненные контакты перепаяны попарно между собой. Рефлектор позволял  «отразить» сигнал обратно в шифровальные диски, за счет чего процесс шифрования и расшифрования становился симметричным (одинаковым). Таким образом, например, если буква А заменялась на В, то буква В заменялась на А.
Таблица с внутренними перепайками отражателя представлена ниже.

И, наконец, расскажем о коммутационной панели, впервые появившейся в модели Enigma I в 1932 году. Это набор разъемов по числу символов, зашифровываемых машиной.
Разъемы могут попарно соединяться кабелями, в этом случае после нажатия клавиши сигнал перенаправляется на другой контакт входного диска согласно соединению кабелем.
Например, “A” и “W” могли быть соединены в пару. Например, когда оператор нажимал «A», сигнал направлялся в «W», и только после этого уже во входной диск.
Коммутационная панель вносит наибольшее количество вариантов в множество ключей «Энигмы».

<b>Процедура шифрования</b>
Для шифрования использовался ключ дня, который состоял из следующих пунктов:
1.Дата – день месяца, на который действителен ключ;
2.Диски – три номера дисков, которые занимают позиции 1, 2 и 3 соответственно;
3.Кольца – настройки колец на соответствующих дисках. Кольцо определяло, в какой позиции диск «передаст» вращение соседнему диску;
4.Настройки коммутационной панели – пары разъемов, соединенных кабелями;
5.Идентификационные группы – используются для выработки буквенной идентификационной группы.

Порядок настройки по ключу дня:
1.Выбор набора и порядка дисков
2.Установка колец в нужные положения
3.Установка кабелей коммутационной панели
4.Выбор идентификационной группы (одной из 4 по 3 буквы в каждой)
5.Выработка буквенной идентификационной группы – 2 случайные буквы + идентификационная группа из ключа дня

Также использовался одноразовый ключ, который до 1940 г. выбирался по такому принципу:
 -Выбирается произвольный ключ из 3 букв (ориентация роторов) – например, GHK;
 - Выбранный ключ шифруется дважды на ключе дня, что приводит к сообщению  XMC FZQ;
 - Роторы устанавливаются в позицию GHK;
 - Осуществляется шифрование сообщения.
Итоговый вид сообщения:
1230 = 3tle = 1tl = 250 = WZA UHL =
JKMLP 	SQTGS 	ABTRQ 	PTWYB 	LENDP

Но уже после 1940 г. процесс изменился:
Выбирается случайная стартовая позиция, например WZA;
Выбирается произвольный ключ, например, SXT;
Роторы устанавливаются в позицию WZA и выбранный ключ зашифровывается как сообщение, например, получая результат UHL;
Роторы устанавливаются в позицию SXT;
Осуществляется шифрование сообщения;
Итоговый вид сообщения:
1230 = 3tle = 1tl = 250 = WZA UHL =
JKMLP 	SQTGS 	ABTRQ 	PTWYB 	LENDP

Расшифрование(процедура с 1940 г.) происходило так:
 - Диски машины устанавливаются в состояние, указанное в заголовке сообщения – WZA
 - Вводится зашифрованный ключ сообщения – UHL
 - В результате получается ключ сообщения – SXT
 - Диски устанавливаются в состояние SXT
 - Первые 5 букв сообщения отбрасываются – это  буквенная идентификационная группа
 - Вводится полученное сообщение
 - В результате получается открытый текст
Далее мы расскажем о взломе Энигмы, который потребовал колоссальных технических и интеллектуальных усилий и стал поворотным моментом в истории Второй Мировой войны, так как внес значительный вклад в поражение Германии.


<b>Появление Энигмы</b>
В 1926 году службы радиоперехвата разных стран начинают перехватывать сообщения «Энигмы». Криптоанализ представляется невозможным.
Расположение перепаек контактов в роторах остается неизвестным, а формат ключа и шифровальная процедура неизвестны.
И только в 1931 году Ганс-Тило Шмидт, сотрудник немецкой службы шифрованной связи (Chifrierstelle) позволяет французскому агенту сделать фотографии двух документов:
 - Инструкции по шифровальной машине Энигма
 - Ключевые инструкции для шифровальной машины Энигма
Французская служба дешифрования и сотрудники Комнаты 40 не считают взлом возможным и не прикладывают к нему существенных усилий.

Французы передают фотографии секретных документов Польше. Польское Бюро шифров решает создать группу ученых-математиков для взлома Энигмы. Мариан Адам Реевский - польский математик и криптограф - внес наибольший вклад в это исследование.

С появлением документов Ганса-Тило Шмидта, стали известны следующие параметры Энигмы:
 - Наличие в военной версии коммутационной панели
 - Расположение перепаек в роторах военной версии
 - Процедура шифрования и формат ключа дня
 - Передаваемые немецкие сообщения имели формат:
1230 = 3tle = 1tl = 250 = XMC FZQ =
6 передаваемых отдельно букв – зашифрованный дважды повторенный разовый ключ.

Коммутационная панель увеличивает количество ключей Энигмы. Ее влияние меняет состав циклов, порождаемых каждым начальным состоянием роторов, но не влияет на их количество и длину.
Группа Реевского потратила год на составление каталога состава циклов для каждого начального состояния роторов, входящих в ключ дня – 6*26^3 = 105 456 вариантов
Собирая на основе сообщений одного дня количество и длины циклов между 1 и 4, 2 и 5, 3 и 6 буквами, Реевский мог установить, в каком порядке и начальном положении были установлены роторы Энигмы в исходном состоянии

Если вводить в машину без установленных коммутационных кабелей некоторое перехваченное сообщение, можно иногда получать осмысленные фрагменты, в которых есть замененные буквы:
Одна из пар разъемов, соединенных кабелем на коммутационной панели: LR

После того, как внутреннее устройство роторов было изменено немцами, вместо составления нового каталога Реевский разработал автоматизированную систему быстрой проверки всех возможных вариантов. 6 машин Энигма (по числу комбинаций роторов), объединенные электрическими кабелями и работающие совместно, получили название «бомба»
В 1939 году в связи с усложнение Энигмы польские криптоаналитики не могли продолжать читать сообщения, передаваемые немецкими радистами. Летом 1939 года польское Бюро шифров передало свои наработки (методику взлома, рабочие копии Энигмы, чертежи «бомб») союзникам во Франции и Великобритании
В Великобритании работы по дешифрованию Энигмы продолжились в месте, известном как «Блечли-парк» или «Парк Блечли»

Основными направлениями работы в Блечли-парке:
 - Создание расширенной версии польской «бомбы» на 60 машин Энигма
 - Выявление и использование слабых разовых ключей и состояний – «силей» (cillies) – например, последовательностей «QWZ» или «BNM», а также многократное использование одних и тех же ключей или состояний
 - Выявление закономерностей в ключах дня:
    1.Один и тот же ротор не использовался более двух дней подряд на одной позиции
    2.На коммутационной панели буквы не соединялись со своими соседями в алфавите – например, S не могла быть соединена на R или T

Математику Алану Тьюрингу принадлежит идея разработки и определения в тексте перехваченного сообщения позиции так называемых «шпаргалок» (cribs) - вероятных фрагментов текста.
Тьюринг установил по архиву перехваченных и дешифрованных сообщений, что ежедневно около 6:00 утра передавалась сводка погоды, начинающаяся со слова «wetter»
Следуя примеру Реевского, Тюринг разработал тип «шпаргалки», имеющий замкнутый цикл, связывающий символы открытого текста и перехваченного шифртекста.
На основе таких «петель» Тьюринг спроектировал систему из нескольких (по количеству букв в цикле) машин, которые перебирают все варианты расположения роторов.

Выход каждой машины подключен к входу следующей в цикле, а их начальные состояния идентичны, но все машины кроме первой имеют «сдвиг» в состоянии на определенное количество тактов зашифрования
Когда путем перебора будет найдено верное положение роторов, контур замкнется и загорится лампочка.Такое устройство также было названо «бомбой» по аналогии с «бомбой» Реевского.
Первая «бомба» Тьюринга работа медленно, так что ее пришлось совершенствовать
Проектирование новой версии «бомбы» заняло несколько месяцев и совпало с моментом смены шифровальной процедуры немецкими связистами (1 мая 1940 года) – теперь разовый ключ перестал дважды зашифровываться ключом дня и методика Реевского оказалась не применимой.

Новая версия «бомбы» была создана в августе 1940 года и названа «Agnus Dei» или «Agnes». Таких машин за следующие полтора года было создано еще 15, на отыскание верного положения роторов уходил час.
Для верного определения положения «криба» в перехваченном тексте, использовалось то, что Энигма не может зашифровать букву открытого текста такой же буквой
Путем перемещения «криба» устанавливается такое соответствие, при котором совпадений букв нет.

Отдельно стоит поговорить о сообщениях сети ВМФ (военно-морского флота), которые неизменно доставляли особые сложности при анализе по следующим причинам:
 - Высокая подготовка операторов, не использовавших сообщения с явным форматом
 - Наличие системы сокращений и обозначений, снижающей количество повторений и длину сообщений
 - Наличие продуманной системы выбора разовых ключей и состояний
 - Вращающийся, а не жестко зафиксированный отражатель
 - Больший выбор роторов – набор из 8, а не 5 в комплекте

Британские криптоаналитики предприняли использование контролируемого канала – устанавливали морские мины в известных координатах, затем ожидали сообщения с кораблей ВМФ Германии о новых минах, в которых были указаны известные координаты. Они-то и служили «шпаргалками».
Также периодически удавалось захватывать ключевые книги немецкого ВМФ, что со временем позволило взламывать и сообщения сети ВМФ.
В Великобритании предпринимались специальные усилия для сокрытия факта взлома «Энигмы» - это было критически важно, так как если бы немцы узнали о том, что “Энигма” взломана, они бы усложнили шифр и все предыдущие наработки стали бы бесполезны.

В случаях успешного обнаружения подводных лодок, предпринимались такие меры как:
 - Отказ от атак на отдельные подлодки
 - В случае атаки на собравшуюся для атаки эскадру, части подлодок давали успешно покинуть район битвы
 - При атаке на караваны надводных кораблей также части кораблей давалась возможность покинуть район битвы без повреждений
 - При обнаружении кораблей или подлодок, которые требовалось атаковать, предварительно обеспечивали подтверждение обнаружения с самолета-разведчика
 - Передача ложных сообщений о визуальном обнаружении кораблей противника
Эти меры помогали создать впечатление, что “Энигма” не взломана, а военные победы являются следствием проведенной разведки или банальной случайности.

В одном случае из-за случайности была полностью уничтожена группа танкеров и транспортов ВМФ Германии. Корабли, которые по плану должны были спастись, случайно столкнулись с эсминцами ВМФ Великобритании и были потоплены
Вызванная этим проверка пришла к выводу, что взлом Энигмы на практике невозможен – имеет место случайность или шпионаж в руководстве ВМФ.
<i>Увидеть документы, связанные со взломом «Энигмы», можно в зале  «Механическое сердце» Музея криптографии.</i>


Существование шифра, взломать который невозможно, независимо друг от друга доказали советский ученый Владимир Котельников (в 1941) и американский ученый Клод Шеннон (в 1945). Работа Шеннона «Теория связи в секретных системах» была рассекречена в 1949 году, а полный текст доклада Котельникова до сих пор не опубликован для широкого читателя. Шеннон сформулировал понятия абсолютно стойкого шифра, описал условия построения и использования шифра таким образом, чтобы он являлся абсолютно стойким, показал возможность построения такого шифра на примере шифра Вернама.
<i>Узнать о фигурах Шеннона и Котельникова можно в  «кабинетах» этих ученых в зале  «Криптография в индустриальную эпоху» в Музее криптографии. Там же можно найти и справку о шифре Вернама.</i>
В случае абсолютно стойкого шифра, противник, перехватив шифртекст, не должен получить никакой информации об открытом тексте или выбранном ключе. Таким образом, даже за неограниченное время он не должен иметь возможность дешифровать перехваченное сообщение.

Введём понятия априорных и апостериорных вероятностей.

Для выполнения указанных условий требуется:
 - |X| = |K| = |Y|
 - k ∈ K должен выбираться случайно и равновероятно
 - Любой k ∈ K должен быть случайным и не содержать структур
 - Длина k ∈ K должна быть не меньше длины x ∈ X
 - Ключ должен генерироваться для каждого сообщения, т.е. использоваться один раз

Перехватывая сообщение y, противник должен решить уравнение E(k,x) = y. Но поскольку множества K, X, Y равномощны, то перебирая любое из них, противник переберёт и другие из них. Перебирая все возможные элементы K, противник перебер1т и всё множество X, то есть при некоторых ключах встретит всевозможные открытые тексты, среди которых будет невозможно определить истинный открытый тест.
Примером абсолютно стойкого шифра является шифр Вернама.

В 1917 году Гилберт Вернам, работавший в компании AT&T (Американская телефонная и телеграфная компания), разработал устройство для шифрования одновременно с передачей по телеграфу.
Устройство подключалось к телеграфному аппарату и осуществляло логическую операцию XOR над символом открытого текста и символом ключа накладываемой «гаммы», подаваемой на отдельной ленте.
<b>Логическая операция XOR</b> - это булева функция, таблица аргументов этой функции и  соответствующих значений приведена ниже.

Буквы открытого текста и ключа кодировались определенным образом(например, буква А равна 0001, B - 0010 и тд.) и операция XOR проводилась над кодами каждого символа.
Устройство позволяло осуществлять шифрование или дешифрование текста, передаваемого по телеграфу, причем без участия шифровальщика.

Для его абсолютной криптографической стойкости требовалось соблюдать ряд требований:
 - Последовательность символов на ленте должна была быть случайной
 - Количество символов ключа должно совпадать с количеством символов открытого текста
 - Использовать каждую ленту можно только один раз, после лента должна быть уничтожена
Это затрудняло практическое применение данного шифра.
Получив сообщение, противник должен установить верную гамму для прочтения сообщения. При некоторых значениях гаммы противник будет получать разные осмысленные сообщения, у которых совпадает лишь длина. Для любого сообщения может быть представлена гамма, преобразующая его в перехваченный шифртекст.

Однако шифр Вернама имеет существенные недостатки:
 - Для обеспечения абонентов ключами требуется передавать большой объем информации по защищенному каналу связи.
 - В связи с большим объемом ключей требуется вырабатывать значительный объем случайных данных.
 - Шифр совершенно неустойчив к подмене – противнику легко подделать шифртекст.
Поэтому в настоящее время шифрование Вернама используется достаточно редко, однако оно применяется для защиты особо важных линий связи с относительно небольшим объёмом информации.
Например, англичане и американцы использовали шифры типа Вернама во время Второй мировой войны. Шифр Вернама по модулю 2 использовался на правительственной «горячей линии» между Вашингтоном и Москвой, где ключевые материалы представляли собой бумажные ленты, на которые знаки ключевой последовательности наносились с помощью перфорации.
<i>Увидеть, как выглядела шифровальная техника на горячей линии, ознакомиться с документами о ее создании и с сообщениями, которыми обменивались на линии, можно в соответствующей инсталляции Музея криптографии.</i>


Вторая мировая война сильно повлияла на криптографию. Некоторые её итоги в области криптографии таковы:
 - Шифрование стало автоматизированным, объем передаваемых шифрованных сообщений многократно возрос
 - Для дешифрования сообщений стали применяться сложные электромеханические и электронные устройства
 - Информация в некоторых случаях стала обрабатываться в цифровом виде

Таким образом, к новому шифру выдвигались следующие требования:
 - Возможность повсеместного использования (стандартизация) при обеспечении стойкости за счет секретности выбора ключа
 - Обработка информации в цифровом (двоичном) представлении
 - Стойкость к дешифрованию при помощи вычислительной техники
 - Отсутствие необходимости использовать длинный ключ

Введем понятие блочного шифра.
Под блочным шифром будем понимать шифр, обрабатывающий за 1 применение операции группу символов открытого текста фиксированной длины.
Длина блока – количество символов (букв, бит и т.д.), обрабатываемых за 1 применение функции зашифрования.
Примерами могут служить шифр простой перестановки, решетка Кардано, шифр Плейфера.

Проект Lucifer, исследовательский проект компании IBM, целью которого было создание стойкого блочного шифра. “Люцифер” заложил основы современной симметричной криптографии.
Значительный вклад в его создание внес американский ученый Хорст Фейстель.
Результатом работы этого проекта стало создание 2 принципиальных методов построения стойких блочных шифров, создание нескольких версий действующего шифра Lucifer, вторая версия которого принята как стандарт США – Data Encryption Standard (DES).

<b>Сеть Фейстеля.</b>
Одним из методов построения стойких блочных шифров является сеть Фейстеля. Этот метод основан на многократном повторном преобразовании шифруемого блока некоторой функцией, зависящей от ключа каждой итерации (раунда).
<i>Подробнее о сети Фейстеля можно узнать в Музее криптографии в зале «Цифровая эпоха» в зоне «Криптостандарты».</i>

<b>Алгоритм шифрования.</b>
Информация разбивается на блоки одинаковой (фиксированной) длины. Полученные блоки называются входными, так как поступают на вход алгоритма. В случае если длина входного блока меньше, чем размер, который выбранный алгоритм шифрования способен зашифровать единовременно (размер блока), то блок удлиняется каким-либо способом. Как правило, длина блока является степенью двойки, например, составляет 64 бита или 128 бит.

Далее будем рассматривать операции, происходящие только с одним блоком, так как в процессе шифрования с другими блоками выполняются те же самые операции.

1.Выбранный блок делится на два подблока одинакового размера — «левый» (L0) и «правый» (R0).
2.«Левый» подблок L0 изменяется функцией F с использованием раундового ключа K0:  x = F(L0,K0).
3.Результат складывается по модулю 2 («xor») с «правым подблоком» R0: x  = x ⊕ R0
4.Результат будет использован в следующем раунде в роли «левого подблока» L1: L1=x
5.«Левый подблок» L0 текущего раунда (в своем неизмененном на момент начала раунда виде) будет использован в следующем раунде в роли «правого подблока» R1: R1=L0
6.По какому-либо математическому правилу вычисляется раундовый ключ K1 — ключ, который будет использоваться в следующем раунде.
Перечисленные операции выполняются N-1 раз, где N — количество раундов в выбранном алгоритме шифрования. При этом между переходами от одного раунда (этапа) к другому изменяются ключи: K0 заменяется на K1, K1 — на K2 и т. д.

На принципе сети Фейстеля основан алгоритм блочного шифрования DES (Data Encryption Standard). Он был принят в качестве стандарта в США в 1977 году. Размер блока равен 64 битам, размер ключа – 56 битам, всего 16 раундов.
Советским алгоритм блочного шифрования является «Магма» (ГОСТ 28147-89), который был принят в качестве межгосударственного стандарта в 1990 году. До 1994 года имел гриф «Для служебного пользования».
В нем размер блока равен 64 битам, размер ключа – 256 битам, число раундов – 32.

<b>SP-сеть</b>
Альтернативным методом построения стойких блочных шифров является SP-сеть. Данный метод основан на построении нескольких «слоев» преобразований шифруемого блока – чередующихся перестановок и замен, зависящих от ключа.
Возможно многократное использование пары «слоев» на основе раундовых ключей.
S-блок (от английского substitution box) замещает маленький блок входных бит на другой блок выходных бит. Эта замена должна быть взаимно однозначной, чтобы гарантировать обратимость. Назначение S-блока заключается в нелинейном преобразовании, что препятствует проведению линейного криптоанализа.
P-блок(от английского permutation box) — перестановка всех бит: блок получает на вход вывод S-блока, меняет местами все биты и подает результат S-блоку следующего раунда.

«Кузнечик» – российский алгоритм блочного шифрования, основанный на SP-сети.
Принят в качестве стандарта в РФ в 2015 году,  вступил в действие с 1 января 2016 года.
Размер блока – 128 бит, размер ключа – 256 бит, число раундов – 10.
<i>Подробнее о «Кузнечике» можно узнать из видеоинсталляции в Музее криптографии.</i>

<b>Симметричным шифром</b> (симметричной системой шифрования) называется шифр, при использовании которого для зашифрования и расшифрования используется один и тот же ключ:
Dk(Ek(x)) = x, x ∈ X, k ∈ K
Иными словами, отправитель и получатель для обмена сообщениями должны иметь одинаковый ключ, который является секретным и обеспечивает (согласно принципу Керкгоффса) стойкость шифра.

Для шифров данного типа свойственна следующая проблема – задача распределения ключей:
 - постоянным абонентам нужно иметь запас ключей, который требуется пополнять;
 - большой запас ключей уязвим при хранении и при компрометации может парализовать работу системы связи;
 - в системе с большим числом абонентов необходимо (для соблюдения принципа Керкгоффса) снабдить ключом каждую пару абонентов;
 - добавление нового абонента в сеть связи требует выработки новых ключей для всех абонентов – для связи с новым абонентом.

В связи с этим были инициированы исследования, целью которых являлся поиск возможности распределения ключей без необходимости вырабатывать их заранее и организовывать личную встречу с абонентами для передачи. Иными словами – обойтись без необходимости создания защищенного канала связи (например, передачи из рук в руки).
Авторами концепции асимметричного шифрования – принципа построения криптографических систем, в которых для зашифрования и расшифрования используются отдельные части ключа, соответственно являющиеся секретными или открытыми – стали Уитфилд Диффи и Мартин Хеллман.

В описаниях криптографических алгоритмов, особенно асимметричных, используют классических персонажей:
 - Алиса (Alice) – первый из абонентов/отправитель зашифрованного сообщения;
 - Боб (Bob) – второй из абонетов/получатель зашифрованного сообщения;
 - Ева (Eva) – нарушитель, лицо, стремящееся перехватить и дешифровать пересылаемой между Алисой и Бобом сообщение.

<b>Задача выработки двумя абонентами общего секретного ключа по открытому каналу.</b>
Иллюстрация – Алиса и Боб хотят передать секретную посылку через почту, на которой работает Ева. Алиса навешивает на посылку замок, открыть который может только она, отправляет ее Бобу. Боб получает посылку и навешивает на нее второй замок, открыть который может только он, отправляет ее обратно Алисе. Алиса снимает с посылки свой замок и отправляет ее Бобу. Боб, получив посылку, открывает свой замок. Итог: содержимое посылки безопасно дошло до Боба.

Рассмотрим <b>протокол Диффи-Хеллмана</b> на примере.
Для функции Y = T^x (mod P) Алиса и Боб выбирают несекретные значения P и T. В примере P = 11, T = 7.
Действия Алисы:
Выбирает секретное значение x, А = 3.
Вычисляет T^A (mod P) = 7^3 (mod 11) = 2.
Обозначает α = 2, отправляет вычисленное значение Бобу.
Действия Боба:
Выбирает секретное значение x, B = 6.
Вычисляет T^B (mod P) = 7^6 (mod 11) = 4.
Обозначает β = 4, отправляет вычисленное значение Алисе.
Происходит обмен информацией по каналу, который может подслушивать Ева.
Действия Алисы:
Вычисляет значение β^A (mod 11) = 4^3 (mod 11) = 9
Действия Боба:
Вычисляет значение α^B (mod 11) = 2^6 (mod 11) = 9
9 – общий ключ, выработанный Алисой и Бобом. Ева не может его вычислить, поскольку не знает A или B – секретные значения, выбранные абонентами.
Узнать больше об Алисе и Бобе можно на интерактивном стенде в Музее криптографии.
Узнать больше о протоколе Диффи-Хеллмана можно на стендах «Ключи» и «Диффи-Хеллман» в Музее криптографии.

Рассмотрим <b>атаку «человек посередине»</b>.
Ева, зная P = 11, T = 7, выбирает E = 4, вычисляет T^E (mod P) = 7^4 (mod 11) = 3 = ε. Получает от Алисы α = 2, отправляет ей от имени Боба ε.
Алиса получает от Евы ε, принимает его как β от имени Боба. Вычисляет значение ε^A (mod 11) = 3^3 (mod 11) = 5.
Ева вычисляет значение α^E (mod 11) = 2^4 (mod 11) = 5.
Алиса использует для связи с Бобом ключ «5», который знает Ева.
Боб в это время ожидает от Алисы значение α.
Ева получает от Боба β = 4, отправляет ему от имени Алисы ε. Вычисляет значение β^E (mod 11) = 4^4 (mod 11) = 3.
Боб получает от Евы ε, принимает его как α от имени Алисы. Вычисляет значение ε^B (mod 11) = 3^6 (mod 11) = 3.
Боб использует для связи с Алисой ключ «3», который знает Ева.
Ева же в итоге использует для связи с Алисой ключ «5», представляясь Бобом, и использует для связи с Бобом ключ «3», представляясь Алисой.

Недостатки алгоритма выработки ключей следующие:
 - оба абонента должны находиться во взаимодействии для выработки ключа;
 - новый абонент, для связи с уже существующими абонентами, должен провести с каждым из них процедуру выработки ключа.

 Концепция асимметричного шифрования заключается в следующем:
 - каждый абонент имеет вместо одного ключа ключевую пару, одна часть которой секретна, а другая – общедоступна;
 - любой желающий может, зная открытый ключ получателя, отправить ему зашифрованное сообщение;
 - зашифрованное сообщение не может прочесть никто, кроме обладающего секретным ключом получателя – даже сам отправитель;
 - знание открытого ключа не должно позволять вычислить секретный ключ.

Примером разновидности асимметричного шифрования является <b>криптосистема с открытым ключом</b>:

Авторами реализации концепции асимметричной криптографической системы являются Рональд Райвест, Ади Шамир и Леонард Адлеман. Концепция получила название RSA – «Rivest, Shamir, Adleman».

Выработка ключа происходит так:
Алиса выбирает два простых числа p и q, в примере p = 17, q = 11.
Затем она вычисляет N = p * q, N = 17 * 11 = 187.
Далее выбирает e такое, что (e, ((p-1)*(q-1)))= 1, e = 7.
Пара (N, e)  - открытый ключ Алисы
Алиса вычисляет число d, d: e * d = 1(mod ((p-1)(q-1))),
p = 17, q = 11, e = 7, d: 7 * d = 1 (mod (16 * 10)).
7 * d = 1 (mod 160)
d = 23
Значения p, q и d – секретный ключ Алисы.

Зашифрование:
Боб представляет сообщение в виде числа M. Пусть сообщение равно «X», в виде числа оно равно 88. Тогда M = 88.
Далее вычисляет шифртекст C по формуле: CC = М^e (mod N), C = 88^7 (mod 187) = 11.
Боб пересылает шифртекст Алисе.
Расшифрование:
Алиса определяет открытый текст M по формуле M = C^d (mod N), M = 11^23 (mod 187) = 88.
Таким образом, Алиса получает открытый текст.


В настоящее время криптография используется повсеместно. Например, гражданам государств она позволяет сохранить тайну переписки, коммерческим организациям - обеспечивать безопасные продажи, переводы денежных средств, а злоумышленникам - скрывать свою деятельность от правоохранительных органов.
В 1991 году Филипп Циммерман, американский программист, создал программу “Pretty Good Privacy” (PGP, “вполне достаточная секретность”), которая позволяла всем желающим шифровать электронной письма.
В пакете PGP использовались как асимметричные шифры (RSA, позднее по схеме Эль-Гамаля), так и симметричные (IDEA, позднее ряд других). Рассмотрим принцип работы шифра IDEA.

Разработанный в 1991 году симметричный блочный шифр IDEA основан на модифицированной сети Фейстеля. Он использует 128-битный ключ и 64-битный размер блока и состоит из 8 раундов и завершающего преобразования. В каждом раунде из 128-битного ключа генерируется 6 раундовых ключей, длиной 16 бит, а в завершающем преобразовании генерируется только 4 раундовых ключа. То есть всего  получается 6*8 + 4 = 52 ключа.
Генерация раундовых ключей происходит следующим образом:
 - Сначала 128-битный ключ делится на 8 подстрок по 16 бит, это первые 8 раундовых ключей
 - Чтобы получить ещё 8, необходимо в 128-битном ключе произвести сдвиг влево на 25 бит и снова поделить его на 8 подстрок по 16 бит
 - Предыдущая операция повторяется до тех пор, пока не будем получено необходимое количество ключей

Открытый текст делится на блоки, длиной 64 бита, а каждый блок делится на 4 подблока, длиной 16 бит. Над этими подблоками и раундовыми ключами в соответствии со схемой производятся 3 операции.
А в завершающем преобразовании используются только две последние операции.

Схема симметричного блочного шифра IDEA

Чтобы использовать пакет PGP, сначала отправителю и получателю необходимо установить программу на свой компьютер. Основываясь на случайных нажатиях клавиатуры, движении мыши, создаётся пара ключей для асимметричного шифра и, если требуется, для системы ЭЦП Используя асимметричное шифрование, программа передает от отправителя получателю ключ, который используется для шифрования сообщения симметричным блочным шифром.
Однако появление PGP вызвало негативное реакцию. Во-первых, алгоритм RSA был запатентован и его использование привело к претензиям со стороны правообладателя. Во-вторых, власти США стремились обеспечить возможность взламывать любые шифры, а PGP не допускало такой возможности. В-третьих, в 1993 году Циммерману было предъявлено обвинение в незаконном экспорте вооружения из-за использования PGP за пределами США. В-четвёртых, органы правопорядка высказывали опасение, что опасные преступники смогут избегать ответственности, используя шифрование своей переписки.

В 2012 алгоритм хеширования Keccak стал победителем конкурса криптографических алгоритмов, который проводился с целью принятия нового стандарта SHA-3. В его основе лежит sponge-конструкция, то есть сначала входные данные “поглощаются” в губку, а после различных преобразований результат “выжимается” из губки. Сама конструкция изображена на схеме, где
 - b = r + c = 1600 - размер состояния, ширина
 - r = 1088 - битрейт; большее значение соответствует большей скорости
 - с = 512 - ёмкость: большее значение соответствует большей стойкости
 - f - перестановка
 - pad - правило, по которому входное сообщение M дополняется до сообщения, имеющего размер, кратный r

Sponge-конструкция действует следующим образом:
 - Сначала к входному сообщению применяется правило pad
 - Далее биты состояния инициализируются нулями
 - На фазе “поглощения” (absorbing) каждый r-битный блок строки складывается по модулю 2 с первыми r-битами состояния sponge-конструкции, после чего выполняется перестановка f над всеми b битами состояния. Полученное состояние складывается по модулю 2 с последующим r-битным блоком, и так до тех пор, пока все блоки не “поглотятся”. В конце этой фазы будет сформировано некое состояние S
 - На фазе “выжимания” (squeezing) первые r битов состояния S подаются на выход, после чего выполняется перестановка f над состоянием S. Первые r битов нового состояния подаются на выход, после чего снова выполняется перестановка f, и так до тех пор, пока не будет сформирована последовательность необходимой длины l

Преимуществами Keccak является то, что:
 - Этот алгоритм стал самым производительным на аппаратной реализации среди финалистов конкурса криптографических алгоритмов, а также использовал нераспространённый принцип sponge-конструкции
 - Атаки, рассчитанные на предыдущие алгоритмы SHA-1 и SHA-2, не применимы к данному алгоритму
 - Keccak возможно реализовать на миниатюрных встраиваемых устройствах
 - Малейшее изменение исходного сообщения приводит к значительным изменениям хеш-значения, например:
        1.Hash(«A little body often harbours a great soul») = 2730e312ble5459a3cc23100a838a02c683a4ba926d03257e27a5a84
        2.Hash(«A little body often harbours a great soul.») = e109fd01088302f20159ee5ec87239bd3bb01bf9e600f8cc81858c56

<b>Квантовая криптография</b>
Идеей квантовой криптографии является создание возможности передачи ключей для симметричных алгоритмов при помощи физических объектов, а целью то, что нарушитель лишится возможности считывать передаваемые сообщения незаметно для получателя.
В качестве объекта применяются фотоны света, при этом используются их следующие свойства:
 - Каждый из фотонов имеет поляризацию – одну из 4 (0°, 45°, 90°, 135°).
 - При выборе неверного направления измерения (угол, кратный 90°, или не кратный 90°) поляризация будет изменена, таким образом получатель определит факт измерения

Рассмотрим квантовый алгоритм шифрования BB84:
1.Алиса создает группу фотонов, имеющих одну из 4 поляризаций:

2.Боб, получив фотоны, случайно выбирает направление измерения:

3.Боб согласует свой выбор с Алисой и помечает позиции, в которых он угадал:

4.Результаты измерения поляризации этих фотонов принимаются за значения «0» или «1»:

Таким образом, в современном обществе криптография становится доступной всем пользователям, а её распространение поддерживается сторонниками гражданских прав, в частности, права на тайну переписки. Однако распространение криптографии мешает специальным службам и правоохранительным органам в поиске шпионов и преступников, поэтому некоторые правительства могут относиться к стойкой криптографии аналогично тому, как они относятся к оружию.